# ####################################### 
# Generated by Solution Manager Deployment on 2023-03-07 18:16:51.730
# Generated with Denodo Platform 8.0 update 20220815.

# #######################################
# RESOURCES
# #######################################
# #######################################
# JARS
# #######################################
# #######################################
# USER CREATION
# #######################################
DROP USER IF EXISTS a;

CREATE USER a 'op2aGvbspN/dbq8OtryXlJmC9lg+PFiXa4qw1/Gqz/2OzP8zdUVlKvXk0q7iL9koOxChANOGfY2/7C++UTowXeXm5fQsh3wn2DEoT/IngQwjQEQDr8cu2DTrDlMab62anLEEogCyQCX+c1+gNAdAL2yMdTFBLPBQD+jo0askn4PgNYlz/3WkQTBMdK9fjWC59SwqW7djPIrbXcOrhdscXAkBztLxl31GoLbtK0emfl9KwZ6drHcr7mR3Hxa+LFEe'  ENCRYPTED HASH SHA512  '';

# #######################################
# ROLE CREATION
# #######################################
# #######################################
# TAG CREATION
# #######################################
# #######################################
# CONFIGURATION PROPERTIES
# #######################################

CONNECT DATABASE admin;

SET 'com.denodo.security.file.privilege.generalaccess' = 'K7dUSelgBvSpnh4gVmrTixumpdkLjrgjLQFOU2n1aU3lxDlVuku2hptVzDekXOw84EM/d9cykO+Z1Ky+Hidkq4zLSb8UVeTHf9VMb6xCrlXaakRi8sPlZr7fm2XS5fyr' ENCRYPTED;

SET 'com.denodo.vdb.cache.cacheMaintainerPeriodInSecs' = 'qZ+iY7vgPHWGv7li3grnop2R6SXbuqRhUa+QZ2TmAPeuBDJXM7GkroYBbFeZi8vgo0L6F9esfvCRM38oOC9Q3itpK/8CEHg7kZ0Y3wwtIwzZ8Duj69/SLCVNIdxOE5Tt' ENCRYPTED;

SET 'com.denodo.vdb.cache.cacheMaintenance' = 'EfJnXB1S0F1GQRx3LX6niJGNru9KA2tDYTq9MD2KxnQ9hHVfQEcQL8/cPhSOwEd9TgUQwmRLgXRJvkE4uuFMyP4mQAIcWl9eyVEQd1YBSeMOQU++AUpaaYqt/VVI10V7' ENCRYPTED;

SET 'com.denodo.vdb.cache.cacheStatus' = 'yFYGHY9ZaWZWnXlOJtndu8hJTgEfnkd/tlzzI+nRfhgT4fvz5e/5J6lPCokDown1sUYj+hQpESDqeIPBBDfQtz8baCUGriwbI5UcX3yOi9WUOstgq0gghJt+4YSgBxim' ENCRYPTED;

SET 'com.denodo.vdb.cache.jdbc.customCacheDataSourceName' = 'IjXvdcbuC1we2ybZdqAwcYOaBmbKFfHdAPVu28xx5o7DmtBY+UobIc2o7f7ETS7ualKPBOStcaHpy3ALiLDegb+AjhPY5NIGa1bp9JVtdhHnI+Qr6el/Ho+XXVljBP8CzbBOKVK+k2KVMo0UBRK4EQ==' ENCRYPTED;

SET 'com.denodo.vdb.cache.jdbc.derbyCachePort' = 'fSImvQqoMHS1GFNhw0HmZRHMjXmxLwKgmCcphC+SqvDtteh0QotrYIgYKPaUzEixQqYWwg21ZORJ+UkdqIRy574/frmlj2YQiJHQhS41ZyB6PWom4FYpuguIdtQZJa9H' ENCRYPTED;

SET 'com.denodo.vdb.cache.jdbc.derbyCacheRemoteAccess' = 'Em7MV24adcut16ya5Ibp8jqc5ZD455eemZAK12xjr5l7ooyrowRgOXrjtU/yfH8sAyB7QiqZGTKT/op224x/+rGCNh3XAtIeoqmyDzw5gJTOMBTOsHhusjjbVa5lSRG5' ENCRYPTED;

SET 'com.denodo.vdb.cache.jdbc.serverCacheDataSource' = 'DA7LhVAS62Tyt6mPpC6Ikc0YkMMWO4aJR5FzAVMao2d0e1JR/7XLvGSSyaI4WAg8cEo3hnl5FQL9ykON9ez58O8NBvCBg1EFOzNVl+05kWNZCF0ldc1hLIKxpyG8KeynTSUUhkE3/dFNx9f7n9PQZw==' ENCRYPTED;

SET 'com.denodo.vdb.cache.timeToLiveInSecs' = 'NM1WoGcUA9LuslDmbFdKXHlOvE0ms7Eb1xhw6QVj4jwANzvNkzSlL20hnfExSDOosoY5J6dnsl6hoVPHDs5PIVa+clJqSqecLHkjvpSmnCC4ajOqPR+wZBHTVfAzDhaf' ENCRYPTED;

SET 'com.denodo.vdb.catalog.database.identifiersCharset' = 'bhXUOGP0WkUbblH6HNN0NUTiiQx3xkGyudl3YCrKDC8elL2tgzAgo8A/UR+Lqrl5w9tK7o4036HMbBPCDmTflRZm59hzQm+UNI0NeEF2w6wIaM2gFxPop7Z7fLEQXvdE' ENCRYPTED;

SET 'com.denodo.vdb.engine.RowQueueSizeInMB' = 'gWee9pBnMmwWEXoZt1zJls6J9MnThCDMJwADtj1dXSEzWLPijk/H+Ba8/PeMoh2B+3x+fUaAYa0IFoSG7eZrpbup6VRJGClGhDIWEH9hrG45keAN4tjL/fTc+1PH4wJL' ENCRYPTED;

SET 'com.denodo.vdb.engine.resource.queryMemoryLimit' = 'WvCCv5uYErgKVs7/KEzFMsO03R6VijuiOGu+PhWPQUjv001SxVUyS+Wt3BpwkmsXHcJ/Z0/GS8FvcUSYEGJ98cJxH/UihxlY3jXB1Oa0zeCRLjdyB/LIJAIR5r9fciic' ENCRYPTED;

SET 'com.denodo.vdb.engine.session.restriction.ResourceManagerEngine.resourceManagerStatus' = 'wlAwoaUcQl2iHSEaMpUgE9yo3wpa+DmjIKsb04THb8uGp2VKUZd5pOntafbyr2Nm3OflWzEKNq+Zbfgp+0NhZAXPbqDKHjxV2vqYm1TWlbOdeVxOSie59SLd5S8ObhNJ' ENCRYPTED;

SET 'com.denodo.vdb.engine.swap.SwapManager.maxBlockSizeInKB' = 'egFTHIjmLuAubQYZdDVgje1BZ3FPu2NNj+59cHtqBF9bs9aIb+kqfwDkWbmvReWgt6nXk+nWblYBxKZt36A7gzsuXxieIpnxV21w6047S5yD0EfMbrSbj7aFMRfq/eem' ENCRYPTED;

SET 'com.denodo.vdb.engine.swap.SwapManager.swappingResultMaxSizeInMB' = 'RQpqMganUf05AA4Qbh4ML0qQUkTpSxMTF5u1qPdrlflKRuJbHxJamAFHLK2m1eocwSwEviMhXzpJej2rloBvo+boih7PZeKCfOY8JXmpBzN0eMGuVSXGJGXe9MkXs5GW' ENCRYPTED;

SET 'com.denodo.vdb.engine.swap.SwapManager.swappingStatus' = 'jdvrKdbgH3LkrHBcAz2POka8MO207+WM4YJ5VMEuvfusSa4wkS0XqIuYfo3ioHmohHY/gLgPUGr+5/8VVffPKJEavrfoDTpbBD8ZnbgbpUJmWsWSnU5LkMCL9eemyHJM' ENCRYPTED;

SET 'com.denodo.vdb.engine.wrapper.raw.ldap.LDAPAccess.LDAPDefaultPageSize' = '5dwDsqnwB65G0hhqfDg4+mSjWSvg6pKGIi4XbeExS6OKXLomJOZ9X5h/00M4IH00YDszdPAuMpoHRRd672415+Kawt0VhEWUnQdE/fKAP0uKkWSNwAu6/M0lwQEic4rn' ENCRYPTED;

SET 'com.denodo.vdb.interpreter.execution.SelectAction.costoptimization' = 'opYJPOdX5Hs3srLi5Sw4jPvyQpPqhFbC5KpGixo5AWERACULd9M/hajWsUedpFErbes5qEZhhPXf2etTxlhXY8e1JrnXtMBZtA+1GWZqKycDAKw5CNWOa/TQ+TtQNrVa' ENCRYPTED;

SET 'com.denodo.vdb.interpreter.execution.SelectAction.dataMovement' = '78R2B+C5R2YKmtHQVET6vtKK8SnGTbomqihfwoXzCOjnyhea7t4C/NY3MIR1TPHsVgF5pOyyOKyXPDOreqoWpdBkJS9sTnw4VYpGx6fQBQ9RGh00DiClB6X1Z3+nD+rN' ENCRYPTED;

SET 'com.denodo.vdb.interpreter.execution.SelectAction.simplify' = 'e77+hg+afr8r3YkhjrTxgzI7hiGHahRUI+6Pxk74KTOaJdcn4DpgOw/KtG41K3n0ZdEAfpPbAbwIJx3je0X3y/PIwRqWvhFN670lu3P/ESKNFVYRyvHpD1MNlRp8yzXZ' ENCRYPTED;

SET 'com.denodo.vdb.interpreter.execution.SelectAction.summaryRewrite' = 'uWb9vjO3AozJKEat+Dhf3uklzwiio2ePZ2Tw688mK7qWfscqdyi3+zhTxgnD/jL8PdBrzAyX+pE6f9tGChNNUeCusnkETMma12hVhAwtPfhnGaT8HK3NSuz/s1PLN7cs' ENCRYPTED;

SET 'com.denodo.vdb.interpreter.execution.processor.VDBActionProcessor.concurrentQueriesLimit' = 'skpoOtmKa7uDOMnEsSxquzIc96USjCyFXrc14CfU6vF+L1tVKf11Um0RzNukY7vDwQ6RKh2zz4dMRM0gX1YhBLxk9QnoSPrJ448+9ErnEH1Y/y3iAganBnMmFx9w87jy' ENCRYPTED;

SET 'com.denodo.vdb.interpreter.execution.processor.VDBActionProcessor.maxConcurrentQueries' = 'IoWBxu834lXbVkpzFWUu9zuXRcYSAwxLCF40gFXcPIYxGc5aEvmtYWa0JX5wopnc0OPWJt2Sb7GuS8hl+zotURD0CkirxnG0UAsPgCd5bPn3z6n+HZlwecCz6n1Fkcmz' ENCRYPTED;

SET 'com.denodo.vdb.interpreter.execution.processor.VDBActionProcessor.maxWaitingQueries' = 'OUA50QsSyuieYMFOuYAyTB/140XpDdXjCn8acQPRMk3SgHhZbT8Pfp5KhgFY4TKLxPhbLyXWKb3Fo29rcpMbh3pm6EiYpv6tZEHl4ZFUgMU0lUsAdhbnt2HRnQMXrJUD' ENCRYPTED;

SET 'com.denodo.vdb.interpreter.execution.processor.VDBActionProcessor.waitingQueriesLimit' = 'Jxvz+WtP0S1nlTU8EqSgVCWmWRFWYvTm/MLgfT1jSyQMQBbjDGx1YFSaFrpvgmqFSh5YRba5KsLQ/mu/dLd3cKiKNR2xtq791ZMLCHfVMRvzDeMZ8969uQiGmf9BqIpQ' ENCRYPTED;

SET 'com.denodo.vdb.misc.I18nParametersManager.i18nDefault' = 'tWuj2qgmh1G2Ksszh5V3Y2UlBc0R51dW2XC3i5lfz8EuHkdsePgdrqRXbWCo/t4hjey0cdcH+V3gPSNiIoi0HIKFkHNI2mLgWce9VBWwR6jO88iuMY89xojhPfpVVvPo' ENCRYPTED;

SET 'com.denodo.vdb.proxy.proxyHost' = 'xYO2OQfsUu+A00LMnFmDjFgdNUqEgAXESQ99vuIGSN5GU2keQ1gd7mVf6GAtv0xZqwqd26tSKB4aRksIAaBmqyy4sUrcEcXm6Zzf0JqNEQtYhCZzbV8XWu8dY25+dFKf' ENCRYPTED;

SET 'com.denodo.vdb.proxy.proxyPacUri' = 'm6Ot/4SGnehyeoCpTn+87cGHnDUAP2MkDXC8g96eaOalo5aQEJUw3snMKRIPOvkLEHYd439jILOF+RvlcLCFoI/lwG5YC8gfHNOwaNXTDqPoIBKYPY/ndeP1//XA5Oqb' ENCRYPTED;

SET 'com.denodo.vdb.proxy.proxyPassword' = 'yHFW37ffAOkXs8ZGC9+SHtWBQBL4vYCP4xfLjISuI+cPJCuRTz9fY640WRCjP4ZgTEdB8UY+XpUiaATf2g/dd7HJv6Aftgp0nPj9X+I7kwgC+0JucsXLCKOy+e1URiqS' ENCRYPTED;

SET 'com.denodo.vdb.proxy.proxyPort' = 'V4PO8ZYoDuWJqOUgEPFn+EGcAjYYWZz950qI2zOC8utRv9PPgnyW1S9kgTZGv95NLLxs+1Sr40x4fs0Z/0wxP/uhJ7Xq3HqNSlXsG6qipAJnnX5/8yqSyIIwT79B+KNG' ENCRYPTED;

SET 'com.denodo.vdb.proxy.proxyStatus' = 'WSDD6Y11pwfCpQWDsHMcnutt8Lv3/YT8zCbwRYCL+iVpPwVi8c95DW6k9MM+jcfKZOMGFo1zCm2WcEu37+ZEj0nzmFxKEyvj/kiH0Yv+kBPof2A2CCg5XJgMDsSXv5Ye' ENCRYPTED;

SET 'com.denodo.vdb.proxy.proxyUser' = 'Dj4HsiuMGuXGzHMQ7dR7LDcDga5MadzapjvzlyazFO63mlVgw0bllXOFw0QgaO8AC8FwR4Bb5ALsWIAt3duWWEfN5jXwPxu6rihKgNIc0n7zdHxfcZFoA9I9LW+Rs0D8' ENCRYPTED;

SET 'com.denodo.vdb.vault.enabled' = 'DshVGKmevqj6qrG40XZttOBby8cwHiWPx6KvG/5ri+ysV7j/G0jupa+lLasPBh5a/kDzwZdmagbINgksLuAQmgB3iQck5LhNWjLmlmLgQeRk3qnwL+gzkX0VXuiBCbjp' ENCRYPTED;

SET 'com.denodo.vdb.vault.plugin' = '3On9lUwdPuWMeikWfnPthzRvW6l0OQnZGa9Z2h/I2uQysHUWHy6eTEGgBwWflkCVjtaPLelIyw8FPei9LM8ydVF7K3NPrJCIA+tN8cKWW0It7c5vy7JMbEtEuL9ZYoFQ' ENCRYPTED;

SET 'com.denodo.vdb.vault.plugin.cyberArk.applicationId' = 'Gmik8NgBPGgFQlaH9d60nXIBCdc2WHp/PHcVbwLO2u9OW9FG+497b5aXql1tIDj7VaxmnAzBPVGouBANzCoF0nlIuqbS7ZBTD7cJa6Zv3OKvMctGhBr3yUX3TdkDgwOV' ENCRYPTED;

SET 'com.denodo.vdb.vault.proxyStatus' = 'W+klF6PrxyxGJMBnk5i7NijBtkibsc26I7wawNXEA8iGO8TsKj09kmhcQvUYHpddEGA4I8tNw284ibSe8korD6yuxFAeK84sA1KB51Ybmwl90uU4IbKCj+/OylijNEuD' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.VDBManagerImpl.factoryPort' = 'gZUnYlq7fkxyCN0JA4FLcqN3dvyLntb2FszTKmdBaqliA3U3e7SteW+tylR3xUblxYPZnrFU6xHKXANMQGgGm8PKEdu28WdQGF3XG2ctZR5BVoxF927KjBkPJBVkaWdn' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.VDBManagerImpl.odbcPort' = 'duS1KFzAbNjOPPaG4wAwEeo3fHroHtS18ZgQoOR9VH4u3zv03UbGIVUXD8P2P47HHossBsIo0IYT/C+JGLCGLgW4UGcU9VH+eij17PMD0nIZ+narGFuqgHmFL1NLahjh' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.VDBManagerImpl.port' = 'vJO9rwpOSL9UCZGU6YUsurDPrpOB8ebt7tH+T27iFhSKfqXExuqB4ySV8UL56kq6TdXcymwe9+RirFfGBUQd5lqZDbVaPqU+Nno9NJVu7wEEuPuw3sK/+X9ZeK3Y+n/2' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.VDBManagerImpl.registryPort' = 'NdVLOl9SmFDl67PEJNtJNe4kgI5klVwQC757kbIIYwgnLpt9U4Gv3/sN/fVUVefnscuhXNzDc9U0VaPkM5mx9C/Brpk1Wtz9Xi/BKp2rsh9bFrJ+oqMEQsxioTwOyhRg' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.VDBManagerImpl.registryURL' = 'IplgG2OOm4KNe1/SmqwphfdzfpVasyJTBHLx7uc+ZRYvUlzfSuYF2WUzqBV5fM+bQo84mvucQAmWKsvol9uFgFTeoytxnrEyWYyfHevN20thqJlMukX24ljFNOnm5Yv4' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.VDBManagerImpl.shutdownPort' = '57R3QmSGM20CYbbs+ywl4H3QUQtunI5Pt79XvHfqyd/y5kn0Ib1C39xtuy+b0xcGerle7QzTWkXTqtTPoBoR8D9oVDdsJ0h2isTSbmXqg7irVlcmd7U/vhYrx9u5pmKZ' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.vcs.VCSConfigurationManager.encryptedPassword' = 'WoabhEu/qCRMgML84gV2f9sN3wFVswBpOii6jfadePr/ZS9g0YhwpGzaDRPrHdqAkz/8LlyWd2mRS1XyYorA4fCUTyP7mO2imV/5Kd5Bmo09291Lc9K4+m5lYIGhQGTN' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.vcs.VCSConfigurationManager.environment' = 'Oc6DFJT3X+D5cwcYLjR0JaoDrJpFl1Et1VmWxBDkCa6yAfmXSVYDSUNdqaXA6f11L11Smy2e9JzPoBVbraX/rG+0LVemjzaTWKTvSIcqxYzyW3GD9KodJJypDWktDeC9' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.vcs.VCSConfigurationManager.includeAlwaysDependentGlobalElements' = 'oqV3UxbSKPIUMsZQxLL0/Misg3ctfMID/D2XZpJ92+acENhiAHKCO5MT45gAq+V09aCBEyYqNh6xdp5YcX6yAWbDcpxlYMhwHPXAnrpTbLAn6RUFLi+harV/j/aDt6y+' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.vcs.VCSConfigurationManager.localRepositoriesHome' = 'qhB0Wg+hqqkpoxAn+M8fvcYK/d6pLZK4JHisEofSS96Eo4g4aSwlfO9hF6MiRtdb6CqVXoG5GIz2LOfWA4nT28zHhSm+FQni2qa9fSki7S0s0aYQZNO3cK3keKuYywD3RlXzWASHxnynyezQW4QXzyXFUJrxSiltydkkiIVLM4I=' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.vcs.VCSConfigurationManager.password' = '+oD4G5u9Xh91VTwzGuTNBdDHDrJG5nXekDsNl3krrNAR70GK1vxOcW0s21IsUJgoxQoVZ18YUC4n79p1QwYKsF5E4NeS5NVh6bziuhvgBBWSVbym0l3vyoOTi7Y/ZLue78K6Ue8w46rKNHVXfrKfddLHk6c4Gvi8cRnOoFtN6CHZSOZo309e20IMFU16QM1DiTCbr1A5luEJjxvnpvJ7mH1o3MfL1yZCYtppJM/NADNMcsjqt7ZruvmT8OmkmUUPcNnlHkXE+1mp00Fs+/CKF0ZJQw906svWgy0gdIt3oUpWDDrHS+J6+apAsQLNNY8E7oVSV3FSXrJ5k1wGlrVzEw==' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.vcs.VCSConfigurationManager.system' = 'z5FdxgLrqcS1wZTARKKIpjvxAQeP3wfIl0E5OCuTeFS2LwQMU8Owlef4WJ8qrQccw5y0uyXjW/UEFAy1zkRt0ru0XnJqJ/nwyIu837pD991U7unbgTM4p7eBJWRLfeNX' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.vcs.VCSConfigurationManager.url' = 'q5ayVtO+eftjBPjaS1+iBEKBkWeAivhgiFEG6zPDULypWhPjmNtYY6K1jBs5t8jBQ/o7K2OaahLqiQ4enetmb6VgiUZWgiPp0x/j7aI6iygeUUdaQeqtYc4sm1GUdxVlK6DX0CURfVY7lEmIIBzuYWgiBlSSzk23+ybwsWgsJWE=' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.vcs.VCSConfigurationManager.useKerberos' = 'gGrh+JRiY9tpXxzqEsOGOO6A4j+GTKz2icgK7Nxd3s6gBUJhjAtYnk4BnFm+OTo9ljt7feghWczIxrv+9X3R0jWk7oPWdtmhHi0LR3yuhupTlqbI9DkFHge5AH1jPknq' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.vcs.VCSConfigurationManager.usePassThrough' = 'z2rs75PikGsq6JLGiPHjBsxStUcMyTigUdRdMwkl98S1t7MFOkGJou4/wyMyuS4auyfqxCPpJZqnhsK9liWmVgpHRI09IHqoj54z0zFvXq6R4EzSinasNJa8YYlYQy3M' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.vcs.VCSConfigurationManager.useUserAndPassword' = 'BPkRpq6RlgIpg/khqLgkkwmlUerOLkn+77U7T6AjA7v2oA0Frvg6/hLMCJPOmSFrMXnxvDHiIJif3abnk/D7MryKmP8unn1tR+wpHPxmmeSiEO/itPV0JGxNcSLeubJD' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.vcs.VCSConfigurationManager.useVCS' = 'ZNKs9Yij8Wcp4c2hAE6KZsM4rdGgD4nHY1zwJsQKKLg24zDae27EkxS3X88QKway2bO4hHnEbGw9k/BzikwQQp6QESApokAZVq9rKaho9cW9r20w7FHXOVApIrfNy9ba' ENCRYPTED;

SET 'com.denodo.vdb.vdbinterface.server.vcs.VCSConfigurationManager.user' = 'SDwu/Wo4BY4FCcmDWPkpAEGgzH7wXrG2aCbfIOVfp6vZ6X03AW0nd/M64c6cO/vv/WmG8E6uNXHpjQKBk69R/ggJApkMn5W3p0J2V4agpDpjTGS86LpXxTXbMnQFRNxR' ENCRYPTED;

SET 'com.denodo.wsgenerator.restfulws.timezone' = '0uVJn3+fH07H5anXkC7RegUVZVwnXymBbDfFk3mczX12Hl8fFwuh1tA9KzPGI7hdGyE7BIyuxwBrv5AjFzck4np+nves8+n5napIUsVgDVo/Sf4ioLEHuGv1AXnKzLaT' ENCRYPTED;

SET 'java.env.DENODO_OPTS_START' = 'HHD+EpXvmZsHh/ECK36VLY7spEfuDZtwTjCOj3MqisNzr7vK10MZVrnxrP5WdzVRgJY/Sv9MQRiNtpCkqh9Umc5zNoca6BZxRX0YgZD7VEiwAUDZpTRoIw2lq4NflwvdFD5LBdbmadZ+OPAEGSbQ6mbj4sMOeCHQAfrt+fHen8AzfbQWjSmxcrHcMr9aFuw9YNk2Z8llkaK2NYc64JUBgg==' ENCRYPTED;

SET 'java.env.DENODO_OPTS_STOP' = 'jTHuTBlL7vUAba/6Ep1Q0M9eA+1htajC5EEdE7l9BFOyW44J4Zm6+aqTiGyaeZyp2zD/27Z6Bl5KZ/4T15bsNOoPrBpcQilBQvkt3Wf/fbkdyu0fwxBEcGjG1MrxE1TS' ENCRYPTED;

SET 'queryOptimization.parallelProcessing.customDataSource.dataSourceName' = 'LyPWhBtpp12+L7l8pt7s5x0w7Z3JKXV8J7rC6GXiSha6xTdMSc4kMZ0Y3ke0IyIUSJj6T0BhR0QIeViC+ieCHm0sS0DF0KUgOOPFOImxyBYrfBVIMQqqA6vPUYXKtFoW' ENCRYPTED;

SET 'queryOptimization.parallelProcessing.customDataSource.databaseName' = 'QOez4D+k8Q5aTspvfSXvbs4XOq2r0+myLDnpbcXb4QW+hlnxn3jYfE3RMB2IXkjBFDalF0Cgi5CtFYR2aGlCvLjqIDgLkHtAxunM4cr5e1cUiAWVSx8W/3XbsgVgLMjm' ENCRYPTED;

SET 'queryOptimization.parallelProcessing.dataSource' = 'bCTgeqkWGSzw6FFcETXHxQGp0+9fZmdEYqkPDiICozuGOjd0nHRr/AhiAJWDQajb8rIBseHO0A3yPDt8qrkqr0Jw/Srvl9Ne8mOnXBdFOjBSoghhj5ifDKOO0so9aNOA' ENCRYPTED;

SET 'queryOptimization.parallelProcessing.enabled' = 'tnoVrjOZhYo2ddkgifZDG6DSqWjh2r/bfOh4MM8i/LnwbMOfrK5Yihy7ko6j7YTWqaDBL+drZHGYgyo8ecuwW+rujazrr/cmoudrsHLpLnKB9tet/d3wTpOnBjx6v/Vm' ENCRYPTED;

SET 'storedProcedures.defaultChunkSize' = 'o+45Pfyu/f3Jm/qplR5X78phwmekJS2ELHNde8+p3RlFwMYY6PUlM2rzbexHaUSjnQSL+7ByIukvn61eIV+Cu2ku1Y7bxcqSbCyfd/s+W51GD0US8vy6U7B92jx3VEXw' ENCRYPTED;

SET 'storedProcedures.defaultChunkTimeout' = '2LNMJXiBGMpXCt/52WSh/cX5YnAaKxhX+jMghALEK6U7Udc7u2o/eZwHCnJ/aiPU90c4CijibD9QO2c/Dz9k3GUkJtD14+FAiD9P4z0NlquKURrJJ8Fnrcp2ewbmIi+A' ENCRYPTED;

SET 'storedProcedures.defaultQueryTimeout' = 'Qj9Vy+lXMmNqIry1Y3aGSAdS2MtptQYJOt4cxgrYdWlStTnF4gz3hfhjJVXmZbElnQCiku3pIZ3W9/qvARQxIoHbrMZzs8N9W9Mww9E2VzgUcqldQ+g3KlIFFSnAM1lA' ENCRYPTED;

WEBCONTAINER SET 'com.denodo.tomcat.http.port' = '1mzq+BybRb7qrddlE5zlA6kPnVMFJdr4gnCBPTAxg7palZdChffxTw3EChFu4Qw4twN7Y2GPQQpM9bXlG0iaVVV/02wjjq+QFRrfkeX++tDkqo2vebC+MfJiiOFtlGSN' ENCRYPTED;

WEBCONTAINER SET 'com.denodo.tomcat.jmx.port' = 'nTAYMZsR/5ZmwNrUnpm9iH3UeO90ctbPJUE2EFA1AZcOSZwiijM2BGJ3Y4WwIK3kmSmwyrMZwV5Yl2NjhyxB2LsWh+KFvayJsYIWtjg3kwhEiVlSxeE/2PUcYqzjQxfh' ENCRYPTED;

WEBCONTAINER SET 'com.denodo.tomcat.jmx.rmi.port' = '9cYNOxG7FWicABjW/ZfofoPJP0oPDnkXhS5QXz3d5/59DZSIfRLXU6Mndkj4f8VmPD/VMjyA+6KRA/Qyl6/U7M3P4S3b0HSfgU1UC0O9bLFouwmJAVhfdxqVCR2jvi+k' ENCRYPTED;

WEBCONTAINER SET 'com.denodo.tomcat.shutdown.port' = 'R7VA6vd4Bbv3uGlM1YqGmuaTomlZtQHYA87sgVw8Z1qn5t4Mb/HhBNsAOW2BRTF2ihbRw7GebLIi9lK/QRd2GisEY0xz0zkeAfwHqhvUU8QKj53AiaO99f2Na2LsTN1U' ENCRYPTED;

WEBCONTAINER SET 'java.env.DENODO_OPTS_START' = 'gHuMdJhqB+vUMHpIvKh059TfFtdIPkYoTKHi39LyF987oNc004uTEcKjeG93glVKQjCVOKdaK+JqTUHCs466uk58vl8rqniTlS0ETOIrmQNti2HBHCpVUxt6Y3mFoImrxWjzc8J3o64d6aVhyqDo1P9zD+QREJUeFLYkiESHhN6qS5yGHfOudPEU2OrOk6QrOncDiyIu8j1v/MW5UyciYdTs5nh1Pe0RQfiuaZMbRoIyscIwSDO6Has+PyRaG73fCRABSFosEARstvMjptHRJFggrlSuMUWiDz3aRevPZzJcieXD89vr7AgRI2VjyrXsTTf/F3SDqC80cOFxMOtvNg==' ENCRYPTED;

UPDATE SCRIPTS;

CLOSE;


# 0 ====================================================================

# #######################################
# DATABASE of db_chs
# #######################################
DROP DATABASE IF EXISTS db_chs;

CREATE DATABASE db_chs '';

CONNECT DATABASE db_chs;

# #######################################
# FOLDERS of db_chs
# #######################################
CREATE OR REPLACE FOLDER '/1. Data Sources' ;

CHOWN admin FOLDER '/1. Data Sources';

CREATE OR REPLACE FOLDER '/2. Base Views' ;

CHOWN admin FOLDER '/2. Base Views';

CREATE OR REPLACE FOLDER '/2. base views/Arc_Datamart' ;

CHOWN admin FOLDER '/2. base views/Arc_Datamart';

CREATE OR REPLACE FOLDER '/2. base views/arc_datamart/ID Mapping' ;

CHOWN admin FOLDER '/2. base views/arc_datamart/ID Mapping';

# #######################################
# LISTENERS JMS of db_chs
# #######################################
# No listeners jms in database db_chs
# #######################################
# LISTENERS KAFKA of db_chs
# #######################################
# No listeners kafka in database db_chs
# #######################################
# DATASOURCES of db_chs
# #######################################
DROP DATASOURCE JDBC IF EXISTS arcdatamart CASCADE;

CREATE DATASOURCE JDBC arcdatamart
    FOLDER = '/1. data sources'
    DRIVERCLASSNAME = 'net.sourceforge.jtds.jdbc.Driver'
    DATABASEURI = 'jdbc:jtds:sqlserver://PRDARCMSSQL01.thechildrenshospital.org:1433;databaseName=ARC_DataMart'
    USERNAME = 'svc_denodo'
    USERPASSWORD = '+z0cgIuKdQSrU23jfpnDIdBznO6YFzzM2S6e2NipUQowJq2eVT19m08c9LuX9ynTN3BEnxHdxl6tdENymN40TVmxTjqLYUspb5a3YZN5XTIJI7FGHAw16oJ3iQeMpnzA' ENCRYPTED
    CLASSPATH = 'denodo-jtds-1.3.1'
    DATABASENAME = 'sqlserver'
    DATABASEVERSION = '2016'
    FETCHSIZE = 1000
    VALIDATIONQUERY = 'Select 1'
    INITIALSIZE = 4
    MAXIDLE = -1
    MINIDLE = 0
    MAXACTIVE = 20
    EXHAUSTEDACTION = 1
    TESTONBORROW = true
    TESTONRETURN = false
    TESTWHILEIDLE = false
    TIMEBETWEENEVICTION = -1
    NUMTESTPEREVICTION = 3
    MINEVICTABLETIME = 1800000
    POOLPREPAREDSTATEMENTS = false
    MAXOPENPREPAREDSTATEMENTS = -1
    DATA_LOAD_CONFIGURATION (
        BATCHINSERTSIZE = 1000
    )
    SOURCECONFIGURATION (
        delegateoffset = false,
        delegatescalarfunctionslist = (abs, acos, addday, addhour, addminute, addmonth, addsecond, addweek, addyear, ascii, asin, atan, atan2, case, cast, ceil, char, coalesce, concat, cos, cot, current_date, degrees, div, exp, firstdayofmonth, firstdayofweek, floor, formatdate, getday, getdayofweek, getdayofyear, getdaysbetween, gethour, getmicrosecond, getmillisecond, getminute, getmonth, getmonthsbetween, getnanosecond, getsecond, gettimeinmillis, getyear, instr, lastdayofmonth, lastdayofweek, len, ln, log, lower, ltrim, mod, mult, nextweekday, now, nullif, pi, position, pow, power, previousweekday, radians, rand, removeaccents, repeat, replace, round, rtrim, sign, sin, sqrt, substr, substring, subtract, sum, tan, textcat, textconstant, to_date(literal), to_localdate(literal), to_time(literal), to_timestamp(literal), to_timestamptz(literal), trim, trunc, upper, xmlquery, xpath),
        delegateanalyticfunctionslist = (avg, cume_dist, dense_rank, first_value, lag, last_value, lead, max, min, ntile, percent_rank, percentile_cont, percentile_disc, rank, row_number, sum)
    );

CHOWN admin DATASOURCE JDBC arcdatamart LASTMODIFICATIONUSER admin;

DROP DATASOURCE JDBC IF EXISTS ds_sqlq CASCADE;

CREATE DATASOURCE JDBC ds_sqlq
    DRIVERCLASSNAME = 'com.microsoft.sqlserver.jdbc.SQLServerDriver'
    DATABASEURI = 'jdbc:sqlserver://localhost:1433;databaseName=CollegeInformation;encrypt=false'
    USERNAME = 'sa'
    USERPASSWORD = '+312Gul7HjVfZiCw3XPQ4AMbkZlZ9mwQYhUk0aE27P3J5Uw2doZS81gfuo2uUcJ6Q0WVt2N3A8xxnKcgBLOfQ+5j+GajpDoHt9dHVP0a9HiuDno7yA7OALYh3XKL0L8r' ENCRYPTED
    CLASSPATH = 'mssql-jdbc-10.x'
    DATABASENAME = 'sqlserver'
    DATABASEVERSION = '2017'
    FETCHSIZE = 1000
    VALIDATIONQUERY = 'Select 1'
    INITIALSIZE = 4
    MAXIDLE = -1
    MINIDLE = 0
    MAXACTIVE = 20
    EXHAUSTEDACTION = 1
    TESTONBORROW = true
    TESTONRETURN = false
    TESTWHILEIDLE = false
    TIMEBETWEENEVICTION = -1
    NUMTESTPEREVICTION = 3
    MINEVICTABLETIME = 1800000
    POOLPREPAREDSTATEMENTS = false
    MAXOPENPREPAREDSTATEMENTS = -1
    DATA_LOAD_CONFIGURATION (
        BATCHINSERTSIZE = 1000
    );

CHOWN admin DATASOURCE JDBC ds_sqlq LASTMODIFICATIONUSER a;

# #######################################
# DATABASE CONFIGURATION
# #######################################
ALTER DATABASE db_chs
  CHARSET DEFAULT;

# #######################################
# WRAPPERS of db_chs
# #######################################
DROP WRAPPER JDBC IF EXISTS bv_chs_first CASCADE;

CREATE WRAPPER JDBC bv_chs_first
    DATASOURCENAME=ds_sqlq
    CATALOGNAME='csi' 
    SCHEMANAME='dbo' 
    RELATIONNAME='bv_chs_first' 
    OUTPUTSCHEMA (
        id = 'id' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  SORTABLE,
        name = 'name' :'java.lang.String' (OPT) (sourcetypesize='50', sourcetypeid='12', sourcetypename='varchar')  SORTABLE
    );

CHOWN admin WRAPPER JDBC bv_chs_first LASTMODIFICATIONUSER admin;

DROP WRAPPER JDBC IF EXISTS bv_jh CASCADE;

CREATE WRAPPER JDBC bv_jh
    DATASOURCENAME=ds_sqlq
    CATALOGNAME='CollegeInformation' 
    SCHEMANAME='dbo' 
    RELATIONNAME='bv_jh' 
    OUTPUTSCHEMA (
        regular_staff_month_gl = 'regular_staff_month_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='14', sourcetyperadix='10', sourcetypesize='18', sourcetypeid='3', sourcetypename='decimal')  SORTABLE,
        project_num = 'project_num' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  SORTABLE,
        fiscal_year = 'fiscal_year' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  SORTABLE,
        account_code_rollup = 'account_code_rollup' :'java.lang.String' (OPT) (sourcetypesize='50', sourcetypeid='12', sourcetypename='varchar')  SORTABLE
    );

CHOWN admin WRAPPER JDBC bv_jh LASTMODIFICATIONUSER admin;

DROP WRAPPER JDBC IF EXISTS som_mrn_cross_reference CASCADE;

CREATE WRAPPER JDBC som_mrn_cross_reference
    FOLDER = '/2. base views/arc_datamart/id mapping'
    DATASOURCENAME=arcdatamart
    CATALOGNAME='ID_Mapping' 
    SCHEMANAME='dbo' 
    RELATIONNAME='som_mrn_cross_reference' 
    OUTPUTSCHEMA (
        reference_id_column = 'reference_id_column' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='100', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        reference_id = 'reference_id' :'java.lang.Long' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='19', sourcetypeid='-5', sourcetypename='bigint')  SORTABLE,
        external_id = 'external_id' :'java.lang.Long' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='19', sourcetypeid='-5', sourcetypename='bigint identity')  NOT NULL SORTABLE IS_AUTOINCREMENT
    );

CHOWN admin WRAPPER JDBC som_mrn_cross_reference LASTMODIFICATIONUSER admin;

# #######################################
# STORED PROCEDURES of db_chs
# #######################################
# No stored procedures in database db_chs
# #######################################
# TYPES of db_chs
# #######################################
# No types in database db_chs
# #######################################
# MAPS of db_chs
# #######################################
# No maps in database db_chs
# #######################################
# BASE VIEWS of db_chs
# #######################################
DROP VIEW IF EXISTS bv_chs_first CASCADE;

CREATE TABLE bv_chs_first I18N au_cst (
        id:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10'),
        name:text (sourcetypeid = '12', sourcetypesize = '50')
    )
    CACHE OFF
    TIMETOLIVEINCACHE DEFAULT
    ADD SEARCHMETHOD bv_chs_first(
        I18N au_cst
        CONSTRAINTS (
             ADD id (any) OPT ANY
             ADD name (any) OPT ANY
        )
        OUTPUTLIST (id, name
        )
        WRAPPER (jdbc bv_chs_first)
    );

CHOWN admin VIEW bv_chs_first LASTMODIFICATIONUSER admin;

DROP VIEW IF EXISTS bv_jh CASCADE;

CREATE TABLE bv_jh I18N au_cst (
        regular_staff_month_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '14', sourcetypesize = '18'),
        project_num:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10'),
        fiscal_year:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10'),
        account_code_rollup:text (sourcetypeid = '12', sourcetypesize = '50')
    )
    CACHE OFF
    TIMETOLIVEINCACHE DEFAULT
    ADD SEARCHMETHOD bv_jh(
        I18N au_cst
        CONSTRAINTS (
             ADD regular_staff_month_gl (any) OPT ANY
             ADD project_num (any) OPT ANY
             ADD fiscal_year (any) OPT ANY
             ADD account_code_rollup (any) OPT ANY
        )
        OUTPUTLIST (account_code_rollup, fiscal_year, project_num, regular_staff_month_gl
        )
        WRAPPER (jdbc bv_jh)
    );

CHOWN admin VIEW bv_jh LASTMODIFICATIONUSER admin;

DROP VIEW IF EXISTS som_mrn_cross_reference CASCADE;

CREATE TABLE som_mrn_cross_reference I18N us_mst_mdt (
        reference_id_column:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '100'),
        reference_id:long (sourcetypeid = '-5', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '19'),
        external_id:long (notnull, autoincrement, sourcetypeid = '-5', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '19')
    )
    FOLDER = '/2. base views/arc_datamart/id mapping'
    CACHE OFF
    TIMETOLIVEINCACHE DEFAULT
    ADD SEARCHMETHOD som_mrn_cross_reference(
        I18N us_mst_mdt
        CONSTRAINTS (
             ADD reference_id_column (any) OPT ANY
             ADD reference_id (any) OPT ANY
             ADD external_id (any) OPT ANY
        )
        OUTPUTLIST (external_id, reference_id, reference_id_column
        )
        WRAPPER (jdbc som_mrn_cross_reference)
    );

CHOWN admin VIEW som_mrn_cross_reference LASTMODIFICATIONUSER admin;

# #######################################
# VIEWS of db_chs
# #######################################
# No views in database db_chs
# #######################################
# ASSOCIATIONS of db_chs
# #######################################
# No associations in database db_chs
# #######################################
# WEBSERVICES of db_chs
# #######################################
# No web services in database db_chs
# #######################################
# WIDGETS of db_chs
# #######################################
# No widgets in database db_chs
# #######################################
# WEBCONTAINER WEB SERVICE DEPLOYMENTS of db_chs
# #######################################
# No deployed web services in database db_chs
# #######################################
# WEBCONTAINER WIDGET DEPLOYMENTS of db_chs
# #######################################
# No deployed widgets in database db_chs
# #######################################
# VIEW STATISTICS of db_chs
# #######################################
# No statistics in database db_chs
# #######################################
# Closing connection with database db_chs
# #######################################
CLOSE;


# 1 ====================================================================

# #######################################
# DATABASE of bv_jh
# #######################################
DROP DATABASE IF EXISTS bv_jh;

CREATE DATABASE bv_jh '';

CONNECT DATABASE bv_jh;

# #######################################
# FOLDERS of bv_jh
# #######################################
CREATE OR REPLACE FOLDER '/1_datasources' ;

CHOWN admin FOLDER '/1_datasources';

CREATE OR REPLACE FOLDER '/1_datasources/sqlserver' ;

CHOWN admin FOLDER '/1_datasources/sqlserver';

CREATE OR REPLACE FOLDER '/1_datasources/sqlserver/addit' ;

CHOWN admin FOLDER '/1_datasources/sqlserver/addit';

CREATE OR REPLACE FOLDER '/1_datasources/sqlserver/addit/adw' ;

CHOWN admin FOLDER '/1_datasources/sqlserver/addit/adw';

CREATE OR REPLACE FOLDER '/2_baseviews' ;

CHOWN admin FOLDER '/2_baseviews';

CREATE OR REPLACE FOLDER '/2_baseviews/sqlserver' ;

CHOWN admin FOLDER '/2_baseviews/sqlserver';

CREATE OR REPLACE FOLDER '/2_baseviews/sqlserver/addit' ;

CHOWN admin FOLDER '/2_baseviews/sqlserver/addit';

CREATE OR REPLACE FOLDER '/2_baseviews/sqlserver/addit/adw' ;

CHOWN admin FOLDER '/2_baseviews/sqlserver/addit/adw';

CREATE OR REPLACE FOLDER '/3_derivedviews' ;

CHOWN admin FOLDER '/3_derivedviews';

CREATE OR REPLACE FOLDER '/3_derivedviews/facts' ;

CHOWN admin FOLDER '/3_derivedviews/facts';

CREATE OR REPLACE FOLDER '/4_implementationviews' ;

CHOWN admin FOLDER '/4_implementationviews';

CREATE OR REPLACE FOLDER '/4_implementationviews/facts' ;

CHOWN admin FOLDER '/4_implementationviews/facts';

# #######################################
# LISTENERS JMS of bv_jh
# #######################################
# No listeners jms in database bv_jh
# #######################################
# LISTENERS KAFKA of bv_jh
# #######################################
# No listeners kafka in database bv_jh
# #######################################
# DATASOURCES of bv_jh
# #######################################
DROP DATASOURCE JDBC IF EXISTS adw CASCADE;

CREATE DATASOURCE JDBC adw
    FOLDER = '/1_datasources/sqlserver/addit/adw'
    DRIVERCLASSNAME = 'net.sourceforge.jtds.jdbc.Driver'
    DATABASEURI = 'jdbc:jtds:sqlserver://apldbc1-dc4.dom1.jhuapl.edu:51004/;domain=JHUAPL;instance=D4'
    USERNAME = 'svc-sql-denodo1-dev'
    USERPASSWORD = 'INLz+XcSDqo2bvRqYMoTZWRZz5dGfKFNvm/B0sSwGnVlB141Ry3yRjb/K/mkSqp93qSJiisJ1cpJivXooHER0Xa0xR5eh/bf9krcnT3PuxO/BactqOkRPzOF8BAjddhC' ENCRYPTED
    CLASSPATH = 'jtds-1.3.1'
    DATABASENAME = 'sqlserver'
    DATABASEVERSION = '2016'
    FETCHSIZE = 1000
    VALIDATIONQUERY = 'Select 1'
    INITIALSIZE = 4
    MAXIDLE = -1
    MINIDLE = 0
    MAXACTIVE = 20
    EXHAUSTEDACTION = 1
    TESTONBORROW = true
    TESTONRETURN = false
    TESTWHILEIDLE = false
    TIMEBETWEENEVICTION = -1
    NUMTESTPEREVICTION = 3
    MINEVICTABLETIME = 1800000
    POOLPREPAREDSTATEMENTS = false
    MAXOPENPREPAREDSTATEMENTS = -1
    DATA_LOAD_CONFIGURATION (
        BATCHINSERTSIZE = 1000
    )
    DESCRIPTION  = 'Purpose: SQL Server ADW Database Data Source
Author:    B.Garrett
Date:     1/29/20

Revisions:
Author     Date        Comments
--------------------   ----------------  -------------------------------------------------------------------------------------------------------'
    SOURCECONFIGURATION (
        delegateoffset = false,
        delegatescalarfunctionslist = (abs, acos, addday, addhour, addminute, addmonth, addsecond, addweek, addyear, ascii, asin, atan, atan2, case, cast, ceil, char, coalesce, concat, cos, cot, current_date, degrees, div, exp, firstdayofmonth, firstdayofweek, floor, formatdate, getday, getdayofweek, getdayofyear, getdaysbetween, gethour, getmicrosecond, getmillisecond, getminute, getmonth, getmonthsbetween, getnanosecond, getsecond, gettimeinmillis, getyear, instr, lastdayofmonth, lastdayofweek, len, ln, log, lower, ltrim, mod, mult, nextweekday, now, nullif, pi, position, pow, power, previousweekday, radians, rand, removeaccents, repeat, replace, round, rtrim, sign, sin, sqrt, substr, substring, subtract, sum, tan, textcat, textconstant, to_date(literal), to_localdate(literal), to_time(literal), to_timestamp(literal), to_timestamptz(literal), trim, trunc, upper, xmlquery, xpath),
        delegateanalyticfunctionslist = (avg, cume_dist, dense_rank, first_value, lag, last_value, lead, max, min, ntile, percent_rank, percentile_cont, percentile_disc, rank, row_number, sum)
    );

CHOWN admin DATASOURCE JDBC adw LASTMODIFICATIONUSER admin;

DROP DATASOURCE JDBC IF EXISTS ds_sql1 CASCADE;

CREATE DATASOURCE JDBC ds_sql1
    DRIVERCLASSNAME = 'com.microsoft.sqlserver.jdbc.SQLServerDriver'
    DATABASEURI = 'jdbc:sqlserver://localhost:1433;databaseName=CollegeInformation;encrypt=false'
    USERNAME = 'sa'
    USERPASSWORD = 'XumXQlu/ZS4w+HQyV5zFH507dyM/eJL8gHeuqCPjZDSlwgWH+EWEY5aE16nfCpsmR720nraJcqbfgzjRVzz8bOci7LK5gD9xEFaBJgK+e0wXRddFmwfrbGUxnnH2EEyk' ENCRYPTED
    CLASSPATH = 'mssql-jdbc-10.x'
    DATABASENAME = 'sqlserver'
    DATABASEVERSION = '2017'
    FETCHSIZE = 1000
    VALIDATIONQUERY = 'Select 1'
    INITIALSIZE = 4
    MAXIDLE = -1
    MINIDLE = 0
    MAXACTIVE = 20
    EXHAUSTEDACTION = 1
    TESTONBORROW = true
    TESTONRETURN = false
    TESTWHILEIDLE = false
    TIMEBETWEENEVICTION = -1
    NUMTESTPEREVICTION = 3
    MINEVICTABLETIME = 1800000
    POOLPREPAREDSTATEMENTS = false
    MAXOPENPREPAREDSTATEMENTS = -1
    DATA_LOAD_CONFIGURATION (
        BATCHINSERTSIZE = 1000
    );

CHOWN admin DATASOURCE JDBC ds_sql1 LASTMODIFICATIONUSER admin;

# #######################################
# DATABASE CONFIGURATION
# #######################################
ALTER DATABASE bv_jh
  CHARSET DEFAULT;

ALTER DATABASE bv_jh
  VCS ON (
    REMOTEDB = bv_jh
  );

# #######################################
# WRAPPERS of bv_jh
# #######################################
DROP WRAPPER JDBC IF EXISTS bv_fact_labor_cost_non_dollar_summary_person_expanded CASCADE;

CREATE WRAPPER JDBC bv_fact_labor_cost_non_dollar_summary_person_expanded
    FOLDER = '/2_baseviews/sqlserver/addit/adw'
    DATASOURCENAME=adw
    CATALOGNAME='ADW' 
    SCHEMANAME='dbo' 
    RELATIONNAME='vw_fact_labor_cost_non_dollar_summary_person_expanded' 
    OUTPUTSCHEMA (
        date_key = 'date_key' :'java.time.LocalDate' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='10', sourcetypeid='12', sourcetypename='date')  NOT NULL SORTABLE,
        first_day_month = 'first_day_month' :'java.time.LocalDate' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='10', sourcetypeid='12', sourcetypename='date')  NOT NULL SORTABLE,
        fiscal_year = 'fiscal_year' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  NOT NULL SORTABLE,
        fiscal_month = 'fiscal_month' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  NOT NULL SORTABLE,
        first_day_fiscal_year = 'first_day_fiscal_year' :'java.time.LocalDate' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='10', sourcetypeid='12', sourcetypename='date')  SORTABLE,
        last_day_fiscal_year = 'last_day_fiscal_year' :'java.time.LocalDate' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='10', sourcetypeid='12', sourcetypename='date')  SORTABLE,
        project_num = 'project_num' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='30', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        direct_indirect = 'direct_indirect' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='11', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        project_status_name = 'project_status_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='80', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        project_type_name = 'project_type_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='20', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        project_dept_code = 'project_dept_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='240', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        project_mission_area_code = 'project_mission_area_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='240', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        program_name = 'program_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='170', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        program_area_name = 'program_area_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='8000', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        sponsor_dept_short_name = 'sponsor_dept_short_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='240', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        sponsor_org_short_name = 'sponsor_org_short_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='240', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        contract_num = 'contract_num' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='120', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        contract_id = 'contract_id' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='25', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        project_relation = 'project_relation' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='11', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        parent_project_num = 'parent_project_num' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='10', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        work_program_name = 'work_program_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='80', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        work_program_org_code = 'work_program_org_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='20', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        account_code = 'account_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='80', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        scheduled_hour = 'scheduled_hour' :'java.lang.Long' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        available_hour = 'available_hour' :'java.lang.Long' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        person_num = 'person_num' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='12', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        full_name = 'full_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='40', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        preferred_full_name = 'preferred_full_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='40', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        person_dept_code = 'person_dept_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='20', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        person_org_code = 'person_org_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='20', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        reg_temp_ind = 'reg_temp_ind' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='1', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        person_type_code = 'person_type_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='5', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        person_status_code = 'person_status_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='1', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        full_part_ind = 'full_part_ind' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='1', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        offsite_flg = 'offsite_flg' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='1', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        origin_code = 'origin_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='2', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        actual_org_code = 'actual_org_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='20', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        actual_org_code_name = 'actual_org_code_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='123', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        actual_org_name = 'actual_org_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='100', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        actual_dept_code = 'actual_dept_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='20', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        regular_staff_year_gl = 'regular_staff_year_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_staff_year_dtk = 'regular_staff_year_dtk' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_staff_year_lt = 'regular_staff_year_lt' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_year_gl = 'overtime_staff_year_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_year_dtk = 'overtime_staff_year_dtk' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_year_lt = 'overtime_staff_year_lt' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_annualized_staff_year_gl = 'regular_annualized_staff_year_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_annualized_staff_year_gl = 'overtime_annualized_staff_year_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_staff_hour_gl = 'regular_staff_hour_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='4', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_staff_hour_dtk = 'regular_staff_hour_dtk' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='4', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_staff_hour_lt = 'regular_staff_hour_lt' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='4', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_staff_month_gl = 'regular_staff_month_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_staff_month_dtk = 'regular_staff_month_dtk' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_staff_month_lt = 'regular_staff_month_lt' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_hour_gl = 'overtime_staff_hour_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='4', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_hour_dtk = 'overtime_staff_hour_dtk' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='4', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_hour_lt = 'overtime_staff_hour_lt' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='4', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_month_gl = 'overtime_staff_month_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_month_dtk = 'overtime_staff_month_dtk' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_month_lt = 'overtime_staff_month_lt' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        account_code_rollup = 'account_rollup' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='80', sourcetypeid='12', sourcetypename='varchar')  SORTABLE
    );

CHOWN admin WRAPPER JDBC bv_fact_labor_cost_non_dollar_summary_person_expanded LASTMODIFICATIONUSER admin;

DROP WRAPPER JDBC IF EXISTS bv_jh CASCADE;

CREATE WRAPPER JDBC bv_jh
    DATASOURCENAME=ds_sql1
    CATALOGNAME='CollegeInformation' 
    SCHEMANAME='dbo' 
    RELATIONNAME='bv_jh' 
    OUTPUTSCHEMA (
        regular_staff_month_gl = 'regular_staff_month_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='14', sourcetyperadix='10', sourcetypesize='18', sourcetypeid='3', sourcetypename='decimal')  SORTABLE,
        project_num = 'project_num' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  SORTABLE,
        fiscal_year = 'fiscal_year' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  SORTABLE,
        account_code_rollup = 'account_code_rollup' :'java.lang.String' (OPT) (sourcetypesize='50', sourcetypeid='12', sourcetypename='varchar')  SORTABLE
    );

CHOWN admin WRAPPER JDBC bv_jh LASTMODIFICATIONUSER admin;

DROP WRAPPER JDBC IF EXISTS bv_jh_1 CASCADE;

CREATE WRAPPER JDBC bv_jh_1
    DATASOURCENAME=ds_sql1
    CATALOGNAME='CollegeInformation' 
    SCHEMANAME='dbo' 
    RELATIONNAME='bv_jh_1' 
    OUTPUTSCHEMA (
        regular_staff_month_gl = 'regular_staff_month_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='18', sourcetyperadix='10', sourcetypesize='18', sourcetypeid='2', sourcetypename='numeric')  SORTABLE
    );

CHOWN admin WRAPPER JDBC bv_jh_1 LASTMODIFICATIONUSER admin;

DROP WRAPPER JDBC IF EXISTS bv_jh_num_scale_17 CASCADE;

CREATE WRAPPER JDBC bv_jh_num_scale_17
    DATASOURCENAME=ds_sql1
    CATALOGNAME='CollegeInformation' 
    SCHEMANAME='dbo' 
    RELATIONNAME='bv_jh_num_scale_17' 
    OUTPUTSCHEMA (
        regular = 'regular' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='17', sourcetyperadix='10', sourcetypesize='18', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        project_num = 'project_num' :'java.lang.String' (OPT) (sourcetypesize='10', sourcetypeid='-15', sourcetypename='nchar')  SORTABLE
    );

CHOWN admin WRAPPER JDBC bv_jh_num_scale_17 LASTMODIFICATIONUSER admin;

DROP WRAPPER JDBC IF EXISTS bv_jh_scale_17 CASCADE;

CREATE WRAPPER JDBC bv_jh_scale_17
    DATASOURCENAME=ds_sql1
    CATALOGNAME='CollegeInformation' 
    SCHEMANAME='dbo' 
    RELATIONNAME='bv_jh_scale_17' 
    OUTPUTSCHEMA (
        regular = 'regular' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='17', sourcetyperadix='10', sourcetypesize='18', sourcetypeid='3', sourcetypename='decimal')  SORTABLE,
        project_num = 'project_num' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  SORTABLE
    );

CHOWN admin WRAPPER JDBC bv_jh_scale_17 LASTMODIFICATIONUSER admin;

# #######################################
# STORED PROCEDURES of bv_jh
# #######################################
# No stored procedures in database bv_jh
# #######################################
# TYPES of bv_jh
# #######################################
# No types in database bv_jh
# #######################################
# MAPS of bv_jh
# #######################################
# No maps in database bv_jh
# #######################################
# BASE VIEWS of bv_jh
# #######################################
DROP VIEW IF EXISTS bv_jh CASCADE;

CREATE TABLE bv_jh I18N au_cst (
        regular_staff_month_gl:decimal (sourcetypeid = '3', sourcetyperadix = '10', sourcetypedecimals = '14', sourcetypesize = '18'),
        project_num:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10'),
        fiscal_year:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10'),
        account_code_rollup:text (sourcetypeid = '12', sourcetypesize = '50')
    )
    CACHE OFF
    TIMETOLIVEINCACHE DEFAULT
    ADD SEARCHMETHOD bv_jh(
        I18N au_cst
        CONSTRAINTS (
             ADD regular_staff_month_gl (any) OPT ANY
             ADD project_num (any) OPT ANY
             ADD fiscal_year (any) OPT ANY
             ADD account_code_rollup (any) OPT ANY
        )
        OUTPUTLIST (account_code_rollup, fiscal_year, project_num, regular_staff_month_gl
        )
        WRAPPER (jdbc bv_jh)
    );

CHOWN admin VIEW bv_jh LASTMODIFICATIONUSER admin;

DROP VIEW IF EXISTS bv_jh_1 CASCADE;

CREATE TABLE bv_jh_1 I18N au_cst (
        regular_staff_month_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '22', sourcetypesize = '22')
    )
    CACHE OFF
    TIMETOLIVEINCACHE DEFAULT
    ADD SEARCHMETHOD bv_jh_1(
        I18N au_cst
        CONSTRAINTS (
             ADD regular_staff_month_gl (any) OPT ANY
        )
        OUTPUTLIST (regular_staff_month_gl
        )
        WRAPPER (jdbc bv_jh_1)
    );

CHOWN admin VIEW bv_jh_1 LASTMODIFICATIONUSER admin;

DROP VIEW IF EXISTS bv_jh_num_scale_17 CASCADE;

CREATE TABLE bv_jh_num_scale_17 I18N au_cst (
        regular:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '17', sourcetypesize = '18'),
        project_num:text (sourcetypeid = '-15', sourcetypesize = '10')
    )
    CACHE OFF
    TIMETOLIVEINCACHE DEFAULT
    ADD SEARCHMETHOD bv_jh_num_scale_17(
        I18N au_cst
        CONSTRAINTS (
             ADD regular (any) OPT ANY
             ADD project_num (any) OPT ANY
        )
        OUTPUTLIST (project_num, regular
        )
        WRAPPER (jdbc bv_jh_num_scale_17)
    );

CHOWN admin VIEW bv_jh_num_scale_17 LASTMODIFICATIONUSER admin;

DROP VIEW IF EXISTS bv_jh_scale_17 CASCADE;

CREATE TABLE bv_jh_scale_17 I18N au_cst (
        regular:decimal (sourcetypeid = '3', sourcetyperadix = '10', sourcetypedecimals = '17', sourcetypesize = '18'),
        project_num:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10')
    )
    CACHE OFF
    TIMETOLIVEINCACHE DEFAULT
    ADD SEARCHMETHOD bv_jh_scale_17(
        I18N au_cst
        CONSTRAINTS (
             ADD regular (any) OPT ANY
             ADD project_num (any) OPT ANY
        )
        OUTPUTLIST (project_num, regular
        )
        WRAPPER (jdbc bv_jh_scale_17)
    );

CHOWN admin VIEW bv_jh_scale_17 LASTMODIFICATIONUSER admin;

DROP VIEW IF EXISTS bv_vw_fact_labor_cost_non_dollar_summary_person_expanded CASCADE;

CREATE TABLE bv_vw_fact_labor_cost_non_dollar_summary_person_expanded I18N us_est (
        date_key:localdate (sourcetypeid = '91', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '10', description = 'Reference dim_date'),
        first_day_month:localdate (sourcetypeid = '91', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '10', description = 'First day of the month of the date in the format of YYYY-MM-DD (e.g., 2020-01-01)'),
        fiscal_year:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10', description = 'Fiscal year (October - September) in the format of YYYY (e.g., 2020: when date is between 2019-10-01 and 2020-09-30).'),
        fiscal_month:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10', description = 'Ordinal number indicating the month in the fiscal year (October - September) (e.g., 1: when date is in October).'),
        first_day_fiscal_year:localdate (sourcetypeid = '91', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '10', description = 'First day of the fiscal year (October - September) in the format of YYYY-MM-DD (e.g., 2020-10-01)'),
        last_day_fiscal_year:localdate (sourcetypeid = '91', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '10', description = 'Last day of the fiscal year (October - September) in the format of YYYY-MM-DD (e.g., 2021-09-30)'),
        project_num:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '30', description = 'It identifies a project (5-characters). It also called subtask_id or task_id in legacy system.'),
        direct_indirect:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '11', description = 'Direct or indirect project indicator: Direct, Indirect, Unspecified'),
        project_status_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '80', description = 'Project status (e.g., PENDING, ACTIVE, CLOSED OUT, COMPLETE)'),
        project_type_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '20', description = 'Project type (e.g., Contract, Grant)'),
        project_dept_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '240', description = 'A code to identify a department or sector that owns the project (e.g., AMDS, AOS).'),
        project_mission_area_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '240', description = 'A code to identify a project mission area (e.g., CO, CS, HP).'),
        program_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '170', description = 'Name of the project program (e.g. ADVANCED SCIENCE & TECHNOLOGY DEVELOPMENT, HEALTH SURVEILLANCE)'),
        program_area_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '8000', description = 'Project program area (e.g. INTEGRATED WARFARE SYSTEMS, RESEARCH & APPLICATIONS)'),
        sponsor_dept_short_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '240', description = 'Sponsor department short name (e.g. NAVAIR, USAFA)'),
        sponsor_org_short_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '240', description = 'Sponsor organization short name (e.g. NAVY, AIR FORCE)'),
        contract_num:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '120', description = 'Contract number. It applies to direct project.'),
        contract_id:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '25', description = 'APL designated short name assigned to a contract. It applies to direct project.'),
        project_relation:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '11', description = 'A code to identify project relationship: C (child), S (standalone), P (parent).'),
        parent_project_num:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '10', description = 'Parent project number'),
        work_program_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '80', description = 'Work program name.  A base work program name is 8-character long.'),
        work_program_org_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '20', description = 'A code to identify an owning organization of a work program.'),
        account_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '80', description = 'A code to identify a cost account (e.g., On_Lbr_S1_Reg)'),
        account_code_rollup:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '80', description = 'A code to identify a top level or level 2 cost account in an account hierarchical category for PMR reporting'),
        scheduled_hour:long (sourcetypeid = '-5', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10', description = 'Total number of hours scheduled for a month of a fiscal year'),
        available_hour:long (sourcetypeid = '-5', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10', description = 'Total number of hours available for a month of a fiscal year'),
        person_num:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '12', description = 'An unique number assigned to a person by APL (aka employee id)'),
        full_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '40', description = 'Full name of a person displayed in Outlook.'),
        preferred_full_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '40', description = 'Person preferred name.'),
        person_dept_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '20', description = 'A code to identify a department organization'),
        person_org_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '20', description = 'A code to identify an APL HR organization'),
        reg_temp_ind:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '1', description = 'It indicates that a person is regular or temporary employee (e.g. T, R).'),
        person_type_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '5', description = 'A code to specify a person type (e.g. RSE, OAS, APLR, OSNE, FCU, APL).  It is derived from person_subtype_code.'),
        person_status_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '1', description = 'A code to specify a status of a person (e.g. A = Active, I = Inactive)'),
        full_part_ind:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '1', description = 'It indicates that a person is part-time or full-time employee (e.g. F = Full-time, P = Part-time)'),
        offsite_flg:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '1', description = 'It flags whether a person is offsite or not.'),
        origin_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '2', description = 'A code to specify where the cost data came from (e.g., DW, GL, LD, LT, TK)'),
        actual_org_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '20', description = 'A code to identify an APL HR organization.'),
        actual_org_code_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '123', description = 'Org Code + ''-'' + Org Name'),
        actual_org_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '100', description = 'APL HR organization name.'),
        actual_dept_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '20', description = 'A code to identify a department organization'),
        regular_staff_year_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) processed through the General Ledger for a closed pay period converted to Staff Years by dividing by the number of productive hours for a Fiscal Year (1810).  This data is sourced from the Data Warehouse and occurs approximately mid month and at month end.'),
        regular_staff_year_dtk:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) recorded and saved in Etime by 6:30pm that day for an open pay period converted to Staff Years by dividing by the number of productive hours for a Fiscal Year (1810).  This data is sourced from the Data Warehouse on a nightly basis.'),
        regular_staff_year_lt:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) associated with a time card that has not been submitted and approved by 7pm Tuesday following the end of a pay period converted to Staff Years by dividing by the number of productive hours for a Fiscal Year (1810).  This data is sourced from the Data Warehouse on a nightly basis.'),
        overtime_staff_year_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Overtime hours processed through the General Ledger for a closed pay period converted to Staff Years by dividing by the number of productive hours for a Fiscal Year (1810).  This data is sourced from the Data Warehouse and occurs approximately mid month and at month end.'),
        overtime_staff_year_dtk:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Overtime hours recorded and saved in Etime by 6:30pm that day for an open pay period converted to Staff Years by dividing by the number of productive hours for a Fiscal Year (1810).  This data is sourced from the Data Warehouse on a nightly basis.'),
        overtime_staff_year_lt:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Overtime hours associated with a time card that has not been submitted and approved by 7pm Tuesday following the end of a pay period converted to Staff Years by dividing by the number of productive hours for a Fiscal Year (1810).  This data is sourced from the Data Warehouse on a nightly basis.'),
        regular_annualized_staff_year_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Actual regualr hours worked for a pay period (Etime) that have been normalized to an 80 hour pay period and then summed through the closed month.  Hours then converted to Annualized Staff Years by dividing by the total number of productive hours up to the closed month as defined by the accounting calendar both sourced from the Data Warehouse. Includes both APL and LW hours.'),
        overtime_annualized_staff_year_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Actual overtime hours worked for a pay period (Etime) summed through the closed month that are converted to Annualized Staff Years by dividing by the total number productive hours up to the closed month as defined by the accounting calendar both sourced from the Data Warehouse. Includes both APL and LW hours.'),
        regular_staff_hour_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '4', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) processed through the General Ledger for a closed pay period.  This data is sourced from the Data Warehouse and occurs approximately mid month and at month end.'),
        regular_staff_hour_dtk:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '4', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) associated with a time card that has not been submitted and approved by 7pm Tuesday following the end of a pay period.  This data is sourced from the Data Warehouse on a nightly basis.'),
        regular_staff_hour_lt:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '4', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) recorded and saved in Etime by 6:30pm that day for an open pay period.  This data is sourced from the Data Warehouse on a nightly basis.'),
        regular_staff_month_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) processed through the General Ledger for a closed pay period converted to Staff Months by dividing by the number of productive hours for that month.  This data is sourced from the Data Warehouse and occurs approximately mid month and at month end.'),
        regular_staff_month_dtk:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) recorded and saved in Etime by 6:30pm that day for an open pay period converted to Staff Months by dividing by the number of productive hours for that month.  This data is sourced from the Data Warehouse on a nightly basis.'),
        regular_staff_month_lt:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) associated with a time card that has not been submitted and approved by 7pm Tuesday following the end of a pay period converted to Staff Months by dividing by the number of productive hours for that month.  This data is sourced from the Data Warehouse on a nightly basis.'),
        overtime_staff_hour_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '4', sourcetypesize = '38', description = 'Overtime hours processed through the General Ledger for a closed pay period.  This data is sourced from the Data Warehouse and occurs approximately mid month and at month end.'),
        overtime_staff_hour_dtk:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '4', sourcetypesize = '38', description = 'Overtime hours recorded and saved in Etime by 6:30pm that day for an open pay period.  This data is sourced from the Data Warehouse on a nightly basis.'),
        overtime_staff_hour_lt:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '4', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) associated with a time card that has not been submitted and approved by 7pm Tuesday following the end of a pay period.  This data is sourced from the Data Warehouse on a nightly basis.'),
        overtime_staff_month_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Overtime hours processed through the General Ledger for a closed pay period converted to Staff Months by dividing by the number of productive hours for that month.  This data is sourced from the Data Warehouse and occurs approximately mid month and at month end.'),
        overtime_staff_month_dtk:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Overtime hours recorded and saved in Etime by 6:30pm that day for an open pay period converted to Staff Months by dividing by the number of productive hours for that month.  This data is sourced from the Data Warehouse on a nightly basis.'),
        overtime_staff_month_lt:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Overtime hours associated with a time card that has not been submitted and approved by 7pm Tuesday following the end of a pay period converted to Staff Months by dividing by the number of productive hours for that month.  This data is sourced from the Data Warehouse on a nightly basis.')
    )
    FOLDER = '/2_baseviews/sqlserver/addit/adw'
    DESCRIPTION = 'Purpose: ADW base view for vw_fact_labor_cost_non_dollar_summary_person_expanded

Author:    J.Grepps
Date:     04/14/22

Revisions:
Author			Date		Comments
--------------------   -------------	-------------------------------------------------------------------------------------------------------'
    CACHE OFF
    TIMETOLIVEINCACHE DEFAULT
    ADD SEARCHMETHOD bv_fact_labor_cost_non_dollar_summary_person_expanded(
        I18N us_est
        CONSTRAINTS (
             ADD date_key (any) OPT ANY
             ADD first_day_month (any) OPT ANY
             ADD fiscal_year (any) OPT ANY
             ADD fiscal_month (any) OPT ANY
             ADD first_day_fiscal_year (any) OPT ANY
             ADD last_day_fiscal_year (any) OPT ANY
             ADD project_num (any) OPT ANY
             ADD direct_indirect (any) OPT ANY
             ADD project_status_name (any) OPT ANY
             ADD project_type_name (any) OPT ANY
             ADD project_dept_code (any) OPT ANY
             ADD project_mission_area_code (any) OPT ANY
             ADD program_name (any) OPT ANY
             ADD program_area_name (any) OPT ANY
             ADD sponsor_dept_short_name (any) OPT ANY
             ADD sponsor_org_short_name (any) OPT ANY
             ADD contract_num (any) OPT ANY
             ADD contract_id (any) OPT ANY
             ADD project_relation (any) OPT ANY
             ADD parent_project_num (any) OPT ANY
             ADD work_program_name (any) OPT ANY
             ADD work_program_org_code (any) OPT ANY
             ADD account_code (any) OPT ANY
             ADD account_code_rollup (any) OPT ANY
             ADD scheduled_hour (any) OPT ANY
             ADD available_hour (any) OPT ANY
             ADD person_num (any) OPT ANY
             ADD full_name (any) OPT ANY
             ADD preferred_full_name (any) OPT ANY
             ADD person_dept_code (any) OPT ANY
             ADD person_org_code (any) OPT ANY
             ADD reg_temp_ind (any) OPT ANY
             ADD person_type_code (any) OPT ANY
             ADD person_status_code (any) OPT ANY
             ADD full_part_ind (any) OPT ANY
             ADD offsite_flg (any) OPT ANY
             ADD origin_code (any) OPT ANY
             ADD actual_org_code (any) OPT ANY
             ADD actual_org_code_name (any) OPT ANY
             ADD actual_org_name (any) OPT ANY
             ADD actual_dept_code (any) OPT ANY
             ADD regular_staff_year_gl (any) OPT ANY
             ADD regular_staff_year_dtk (any) OPT ANY
             ADD regular_staff_year_lt (any) OPT ANY
             ADD overtime_staff_year_gl (any) OPT ANY
             ADD overtime_staff_year_dtk (any) OPT ANY
             ADD overtime_staff_year_lt (any) OPT ANY
             ADD regular_annualized_staff_year_gl (any) OPT ANY
             ADD overtime_annualized_staff_year_gl (any) OPT ANY
             ADD regular_staff_hour_gl (any) OPT ANY
             ADD regular_staff_hour_dtk (any) OPT ANY
             ADD regular_staff_hour_lt (any) OPT ANY
             ADD regular_staff_month_gl (any) OPT ANY
             ADD regular_staff_month_dtk (any) OPT ANY
             ADD regular_staff_month_lt (any) OPT ANY
             ADD overtime_staff_hour_gl (any) OPT ANY
             ADD overtime_staff_hour_dtk (any) OPT ANY
             ADD overtime_staff_hour_lt (any) OPT ANY
             ADD overtime_staff_month_gl (any) OPT ANY
             ADD overtime_staff_month_dtk (any) OPT ANY
             ADD overtime_staff_month_lt (any) OPT ANY
        )
        OUTPUTLIST (account_code, account_code_rollup, actual_dept_code, actual_org_code, actual_org_code_name, actual_org_name, available_hour, contract_id, contract_num, date_key, direct_indirect, first_day_fiscal_year, first_day_month, fiscal_month, fiscal_year, full_name, full_part_ind, last_day_fiscal_year, offsite_flg, origin_code, overtime_annualized_staff_year_gl, overtime_staff_hour_dtk, overtime_staff_hour_gl, overtime_staff_hour_lt, overtime_staff_month_dtk, overtime_staff_month_gl, overtime_staff_month_lt, overtime_staff_year_dtk, overtime_staff_year_gl, overtime_staff_year_lt, parent_project_num, person_dept_code, person_num, person_org_code, person_status_code, person_type_code, preferred_full_name, program_area_name, program_name, project_dept_code, project_mission_area_code, project_num, project_relation, project_status_name, project_type_name, reg_temp_ind, regular_annualized_staff_year_gl, regular_staff_hour_dtk, regular_staff_hour_gl, regular_staff_hour_lt, regular_staff_month_dtk, regular_staff_month_gl, regular_staff_month_lt, regular_staff_year_dtk, regular_staff_year_gl, regular_staff_year_lt, scheduled_hour, sponsor_dept_short_name, sponsor_org_short_name, work_program_name, work_program_org_code
        )
        WRAPPER (jdbc bv_fact_labor_cost_non_dollar_summary_person_expanded)
    );

CHOWN admin VIEW bv_vw_fact_labor_cost_non_dollar_summary_person_expanded LASTMODIFICATIONUSER admin;

# #######################################
# VIEWS of bv_jh
# #######################################
DROP VIEW IF EXISTS bv_jh_j_bv_jh_1 CASCADE;

CREATE VIEW bv_jh_j_bv_jh_1 AS SELECT bv_jh.project_num AS project_num, bv_jh.fiscal_year AS fiscal_year, bv_jh.account_code_rollup AS account_code_rollup, bv_jh_1.regular_staff_month_gl AS regular_staff_month_gl FROM bv_jh AS bv_jh, bv_jh_1 AS bv_jh_1;

CHOWN admin VIEW bv_jh_j_bv_jh_1 LASTMODIFICATIONUSER admin;

DROP VIEW IF EXISTS demo CASCADE;

CREATE VIEW demo AS SELECT * FROM bv_jh WHERE project_num = 2;

CHOWN admin VIEW demo LASTMODIFICATIONUSER admin;

DROP VIEW IF EXISTS dv_fact_labor_cost_non_dollar_summary_person_expanded CASCADE;

CREATE VIEW dv_fact_labor_cost_non_dollar_summary_person_expanded FOLDER = '/3_derivedviews/facts' DESCRIPTION = 'Purpose: Denormalized version of the vw_fact_labor_cost_non_dollar_summary_person view

Author:    B.Garrett
Date:     09/24/20

Revisions:
Author     Date        Comments
--------------------   ----------------  -------------------------------------------------------------------------------------------------------
J. Grepps	04/14/22	Due to performance issues and new ADW was created.  This change is to swap out the join and pull data directly from the new ADW view.'  AS SELECT bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.date_key AS date_key, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.first_day_month AS first_day_month, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.fiscal_year AS fiscal_year, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.fiscal_month AS fiscal_month, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.first_day_fiscal_year AS first_day_fiscal_year, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.last_day_fiscal_year AS last_day_fiscal_year, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.project_num AS project_num, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.direct_indirect AS direct_indirect, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.project_status_name AS project_status_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.project_type_name AS project_type_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.project_dept_code AS project_dept_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.project_mission_area_code AS project_mission_area_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.program_name AS program_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.program_area_name AS program_area_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.sponsor_dept_short_name AS sponsor_dept_short_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.sponsor_org_short_name AS sponsor_org_short_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.contract_num AS contract_num, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.contract_id AS contract_id, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.project_relation AS project_relation, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.parent_project_num AS parent_project_num, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.work_program_name AS work_program_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.work_program_org_code AS work_program_org_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.account_code AS account_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.account_code_rollup AS account_code_rollup, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.scheduled_hour AS scheduled_hour, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.available_hour AS available_hour, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.person_num AS person_num, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.full_name AS full_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.preferred_full_name AS preferred_full_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.person_dept_code AS person_dept_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.person_org_code AS person_org_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.reg_temp_ind AS reg_temp_ind, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.person_type_code AS person_type_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.person_status_code AS person_status_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.full_part_ind AS full_part_ind, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.offsite_flg AS offsite_flg, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.origin_code AS origin_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.actual_org_code AS actual_org_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.actual_org_code_name AS actual_org_code_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.actual_org_name AS actual_org_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.actual_dept_code AS actual_dept_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_year_gl AS regular_staff_year_gl, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_year_dtk AS regular_staff_year_dtk, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_year_lt AS regular_staff_year_lt, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_year_gl AS overtime_staff_year_gl, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_year_dtk AS overtime_staff_year_dtk, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_year_lt AS overtime_staff_year_lt, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_annualized_staff_year_gl AS regular_annualized_staff_year_gl, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_annualized_staff_year_gl AS overtime_annualized_staff_year_gl, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_hour_gl AS regular_staff_hour_gl, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_hour_dtk AS regular_staff_hour_dtk, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_hour_lt AS regular_staff_hour_lt, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_month_gl AS regular_staff_month_gl, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_month_dtk AS regular_staff_month_dtk, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_month_lt AS regular_staff_month_lt, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_hour_gl AS overtime_staff_hour_gl, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_hour_dtk AS overtime_staff_hour_dtk, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_hour_lt AS overtime_staff_hour_lt, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_month_gl AS overtime_staff_month_gl, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_month_dtk AS overtime_staff_month_dtk, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_month_lt AS overtime_staff_month_lt FROM bv_vw_fact_labor_cost_non_dollar_summary_person_expanded;

CHOWN admin VIEW dv_fact_labor_cost_non_dollar_summary_person_expanded LASTMODIFICATIONUSER admin;

ALTER VIEW dv_fact_labor_cost_non_dollar_summary_person_expanded
 LAYOUT (bv_vw_fact_labor_cost_non_dollar_summary_person_expanded = [20, 20, 424, 789]);

DROP VIEW IF EXISTS p_bv_jh CASCADE;

CREATE VIEW p_bv_jh AS SELECT bv_jh.regular_staff_month_gl AS regular_staff_month_gl, bv_jh.project_num AS project_num, bv_jh.fiscal_year AS fiscal_year, bv_jh.account_code_rollup AS account_code_rollup FROM bv_jh;

CHOWN admin VIEW p_bv_jh LASTMODIFICATIONUSER admin;

DROP VIEW IF EXISTS impl_fact_labor_cost_non_dollar_summary_person_expanded CASCADE;

CREATE VIEW impl_fact_labor_cost_non_dollar_summary_person_expanded FOLDER = '/4_implementationviews/facts' DESCRIPTION = 'Purpose: Implementation view of the dv_fact_labor_cost_non_dollar_summary_person_extended view

Author:    B.Garrett
Date:     09/24/20

Revisions:
Author     Date        Comments
--------------------   ----------------  -------------------------------------------------------------------------------------------------------'  AS SELECT dv_fact_labor_cost_non_dollar_summary_person_expanded.date_key AS date_key, dv_fact_labor_cost_non_dollar_summary_person_expanded.first_day_month AS first_day_month, dv_fact_labor_cost_non_dollar_summary_person_expanded.fiscal_year AS fiscal_year, dv_fact_labor_cost_non_dollar_summary_person_expanded.fiscal_month AS fiscal_month, dv_fact_labor_cost_non_dollar_summary_person_expanded.first_day_fiscal_year AS first_day_fiscal_year, dv_fact_labor_cost_non_dollar_summary_person_expanded.last_day_fiscal_year AS last_day_fiscal_year, dv_fact_labor_cost_non_dollar_summary_person_expanded.project_num AS project_num, dv_fact_labor_cost_non_dollar_summary_person_expanded.direct_indirect AS direct_indirect, dv_fact_labor_cost_non_dollar_summary_person_expanded.project_status_name AS project_status_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.project_type_name AS project_type_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.project_dept_code AS project_dept_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.project_mission_area_code AS project_mission_area_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.program_name AS program_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.program_area_name AS program_area_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.sponsor_dept_short_name AS sponsor_dept_short_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.sponsor_org_short_name AS sponsor_org_short_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.contract_num AS contract_num, dv_fact_labor_cost_non_dollar_summary_person_expanded.contract_id AS contract_id, dv_fact_labor_cost_non_dollar_summary_person_expanded.project_relation AS project_relation, dv_fact_labor_cost_non_dollar_summary_person_expanded.parent_project_num AS parent_project_num, dv_fact_labor_cost_non_dollar_summary_person_expanded.work_program_name AS work_program_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.work_program_org_code AS work_program_org_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.account_code AS account_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.account_code_rollup AS account_code_rollup, dv_fact_labor_cost_non_dollar_summary_person_expanded.scheduled_hour AS scheduled_hour, dv_fact_labor_cost_non_dollar_summary_person_expanded.available_hour AS available_hour, dv_fact_labor_cost_non_dollar_summary_person_expanded.person_num AS person_num, dv_fact_labor_cost_non_dollar_summary_person_expanded.full_name AS full_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.preferred_full_name AS preferred_full_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.person_dept_code AS person_dept_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.person_org_code AS person_org_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.reg_temp_ind AS reg_temp_ind, dv_fact_labor_cost_non_dollar_summary_person_expanded.person_type_code AS person_type_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.person_status_code AS person_status_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.full_part_ind AS full_part_ind, dv_fact_labor_cost_non_dollar_summary_person_expanded.offsite_flg AS offsite_flg, dv_fact_labor_cost_non_dollar_summary_person_expanded.origin_code AS origin_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.actual_org_code AS actual_org_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.actual_org_code_name AS actual_org_code_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.actual_org_name AS actual_org_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.actual_dept_code AS actual_dept_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_year_gl AS regular_staff_year_gl, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_year_dtk AS regular_staff_year_dtk, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_year_lt AS regular_staff_year_lt, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_year_gl AS overtime_staff_year_gl, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_year_dtk AS overtime_staff_year_dtk, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_year_lt AS overtime_staff_year_lt, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_annualized_staff_year_gl AS regular_annualized_staff_year_gl, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_annualized_staff_year_gl AS overtime_annualized_staff_year_gl, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_hour_gl AS regular_staff_hour_gl, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_hour_dtk AS regular_staff_hour_dtk, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_hour_lt AS regular_staff_hour_lt, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_month_gl AS regular_staff_month_gl, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_month_dtk AS regular_staff_month_dtk, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_month_lt AS regular_staff_month_lt, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_hour_gl AS overtime_staff_hour_gl, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_hour_dtk AS overtime_staff_hour_dtk, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_hour_lt AS overtime_staff_hour_lt, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_month_gl AS overtime_staff_month_gl, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_month_dtk AS overtime_staff_month_dtk, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_month_lt AS overtime_staff_month_lt FROM dv_fact_labor_cost_non_dollar_summary_person_expanded;

CHOWN admin VIEW impl_fact_labor_cost_non_dollar_summary_person_expanded LASTMODIFICATIONUSER admin;

ALTER VIEW impl_fact_labor_cost_non_dollar_summary_person_expanded
 LAYOUT (dv_fact_labor_cost_non_dollar_summary_person_expanded = [20, 20, 431, 792]);

DROP INTERFACE VIEW IF EXISTS fact_manpower_actual_summary_expanded CASCADE;

CREATE INTERFACE VIEW fact_manpower_actual_summary_expanded (
        date_key:localdate (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '10', sourcetypeid = '91'),
        first_day_month:localdate (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '10', sourcetypeid = '91'),
        fiscal_year:int (sourcetypedecimals = '0', sourcetyperadix = '10', sourcetypesize = '10', sourcetypeid = '4'),
        fiscal_month:int (sourcetypedecimals = '0', sourcetyperadix = '10', sourcetypesize = '10', sourcetypeid = '4'),
        first_day_fiscal_year:localdate (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '10', sourcetypeid = '91'),
        last_day_fiscal_year:localdate (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '10', sourcetypeid = '91'),
        project_num:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '30', sourcetypeid = '12'),
        direct_indirect:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '11', sourcetypeid = '12'),
        project_status_name:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '80', sourcetypeid = '12'),
        project_type_name:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '20', sourcetypeid = '12'),
        project_dept_code:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '240', sourcetypeid = '12'),
        project_mission_area_code:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '240', sourcetypeid = '12'),
        program_name:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '170', sourcetypeid = '12'),
        program_area_name:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '8000', sourcetypeid = '12'),
        sponsor_dept_short_name:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '240', sourcetypeid = '12'),
        sponsor_org_short_name:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '240', sourcetypeid = '12'),
        contract_num:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '120', sourcetypeid = '12'),
        contract_id:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '25', sourcetypeid = '12'),
        project_relation:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '11', sourcetypeid = '12'),
        parent_project_num:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '10', sourcetypeid = '12'),
        work_program_name:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '80', sourcetypeid = '12'),
        work_program_org_code:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '20', sourcetypeid = '12'),
        account_code:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '80', sourcetypeid = '12'),
        account_code_rollup:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '80', sourcetypeid = '12'),
        scheduled_hour:long (sourcetypedecimals = '0', sourcetyperadix = '10', sourcetypesize = '10', sourcetypeid = '-5'),
        available_hour:long (sourcetypedecimals = '0', sourcetyperadix = '10', sourcetypesize = '10', sourcetypeid = '-5'),
        person_num:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '12', sourcetypeid = '12'),
        full_name:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '40', sourcetypeid = '12'),
        preferred_full_name:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '40', sourcetypeid = '12'),
        person_dept_code:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '20', sourcetypeid = '12'),
        person_org_code:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '20', sourcetypeid = '12'),
        reg_temp_ind:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '1', sourcetypeid = '12'),
        person_type_code:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '5', sourcetypeid = '12'),
        person_status_code:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '1', sourcetypeid = '12'),
        full_part_ind:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '1', sourcetypeid = '12'),
        offsite_flg:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '1', sourcetypeid = '12'),
        origin_code:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '2', sourcetypeid = '12'),
        actual_org_code:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '20', sourcetypeid = '12'),
        actual_org_code_name:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '123', sourcetypeid = '12'),
        actual_org_name:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '100', sourcetypeid = '12'),
        actual_dept_code:text (sourcetypedecimals = '0', sourcetyperadix = '0', sourcetypesize = '20', sourcetypeid = '12'),
        regular_staff_year_gl:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        regular_staff_year_dtk:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        regular_staff_year_lt:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        overtime_staff_year_gl:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        overtime_staff_year_dtk:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        overtime_staff_year_lt:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        regular_annualized_staff_year_gl:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        overtime_annualized_staff_year_gl:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        regular_staff_hour_gl:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        regular_staff_hour_dtk:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        regular_staff_hour_lt:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        regular_staff_month_gl:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        regular_staff_month_dtk:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        regular_staff_month_lt:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        overtime_staff_hour_gl:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        overtime_staff_hour_dtk:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        overtime_staff_hour_lt:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        overtime_staff_month_gl:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        overtime_staff_month_dtk:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2'),
        overtime_staff_month_lt:decimal (sourcetypedecimals = '16', sourcetyperadix = '10', sourcetypesize = '38', sourcetypeid = '2')
    )
    SET IMPLEMENTATION impl_fact_labor_cost_non_dollar_summary_person_expanded
    DESCRIPTION = 'Expanded Labor Summary By Person Actual Fact data.  Raw fact table joined to dimension tables to include useful attributes for reporting & analytics' ;

# #######################################
# ASSOCIATIONS of bv_jh
# #######################################
# No associations in database bv_jh
# #######################################
# WEBSERVICES of bv_jh
# #######################################
# No web services in database bv_jh
# #######################################
# WIDGETS of bv_jh
# #######################################
# No widgets in database bv_jh
# #######################################
# WEBCONTAINER WEB SERVICE DEPLOYMENTS of bv_jh
# #######################################
# No deployed web services in database bv_jh
# #######################################
# WEBCONTAINER WIDGET DEPLOYMENTS of bv_jh
# #######################################
# No deployed widgets in database bv_jh
# #######################################
# VIEW STATISTICS of bv_jh
# #######################################
# No statistics in database bv_jh
# #######################################
# Closing connection with database bv_jh
# #######################################
CLOSE;


# 2 ====================================================================

# #######################################
# DATABASE of admin
# #######################################
CONNECT DATABASE admin;

# #######################################
# FOLDERS of admin
# #######################################
CREATE OR REPLACE FOLDER '/1_datasources' ;

CHOWN admin FOLDER '/1_datasources';

CREATE OR REPLACE FOLDER '/1_datasources/sqlserver' ;

CHOWN admin FOLDER '/1_datasources/sqlserver';

CREATE OR REPLACE FOLDER '/1_datasources/sqlserver/addit' ;

CHOWN admin FOLDER '/1_datasources/sqlserver/addit';

CREATE OR REPLACE FOLDER '/1_datasources/sqlserver/addit/adw' ;

CHOWN admin FOLDER '/1_datasources/sqlserver/addit/adw';

CREATE OR REPLACE FOLDER '/2_baseviews' ;

CHOWN admin FOLDER '/2_baseviews';

CREATE OR REPLACE FOLDER '/2_baseviews/sqlserver' ;

CHOWN admin FOLDER '/2_baseviews/sqlserver';

CREATE OR REPLACE FOLDER '/2_baseviews/sqlserver/addit' ;

CHOWN admin FOLDER '/2_baseviews/sqlserver/addit';

CREATE OR REPLACE FOLDER '/2_baseviews/sqlserver/addit/adw' ;

CHOWN admin FOLDER '/2_baseviews/sqlserver/addit/adw';

CREATE OR REPLACE FOLDER '/3_derivedviews' ;

CHOWN admin FOLDER '/3_derivedviews';

CREATE OR REPLACE FOLDER '/3_derivedviews/facts' ;

CHOWN admin FOLDER '/3_derivedviews/facts';

CREATE OR REPLACE FOLDER '/4_implementationviews' ;

CHOWN admin FOLDER '/4_implementationviews';

CREATE OR REPLACE FOLDER '/4_implementationviews/facts' ;

CHOWN admin FOLDER '/4_implementationviews/facts';

# #######################################
# LISTENERS JMS of admin
# #######################################
# No listeners jms in database admin
# #######################################
# LISTENERS KAFKA of admin
# #######################################
# No listeners kafka in database admin
# #######################################
# DATASOURCES of admin
# #######################################
DROP DATASOURCE JDBC IF EXISTS adw CASCADE;

CREATE DATASOURCE JDBC adw
    FOLDER = '/1_datasources/sqlserver/addit/adw'
    DRIVERCLASSNAME = 'net.sourceforge.jtds.jdbc.Driver'
    DATABASEURI = 'jdbc:jtds:sqlserver://apldbc1-dc4.dom1.jhuapl.edu:51004/;domain=JHUAPL;instance=D4'
    USERNAME = 'svc-sql-denodo1-dev'
    USERPASSWORD = 'FoVrsnErKt/9EuvPCwUetCASw+7glSm1HovjeQpWlb1pLn9HIVG0pc8uzJLy8ukx0sFixifehiL9CjwXyInYiIE3HWN3F2iq2UPVRqjAIzoKsI//FzoaAfGvaeEQSQVi' ENCRYPTED
    CLASSPATH = 'jtds-1.3.1'
    DATABASENAME = 'sqlserver'
    DATABASEVERSION = '2016'
    FETCHSIZE = 1000
    VALIDATIONQUERY = 'Select 1'
    INITIALSIZE = 4
    MAXIDLE = -1
    MINIDLE = 0
    MAXACTIVE = 20
    EXHAUSTEDACTION = 1
    TESTONBORROW = true
    TESTONRETURN = false
    TESTWHILEIDLE = false
    TIMEBETWEENEVICTION = -1
    NUMTESTPEREVICTION = 3
    MINEVICTABLETIME = 1800000
    POOLPREPAREDSTATEMENTS = false
    MAXOPENPREPAREDSTATEMENTS = -1
    DATA_LOAD_CONFIGURATION (
        BATCHINSERTSIZE = 1000
    )
    DESCRIPTION  = 'Purpose: SQL Server ADW Database Data Source
Author:    B.Garrett
Date:     1/29/20

Revisions:
Author     Date        Comments
--------------------   ----------------  -------------------------------------------------------------------------------------------------------'
    SOURCECONFIGURATION (
        delegateoffset = false,
        delegatescalarfunctionslist = (abs, acos, addday, addhour, addminute, addmonth, addsecond, addweek, addyear, ascii, asin, atan, atan2, case, cast, ceil, char, coalesce, concat, cos, cot, current_date, degrees, div, exp, firstdayofmonth, firstdayofweek, floor, formatdate, getday, getdayofweek, getdayofyear, getdaysbetween, gethour, getmicrosecond, getmillisecond, getminute, getmonth, getmonthsbetween, getnanosecond, getsecond, gettimeinmillis, getyear, instr, lastdayofmonth, lastdayofweek, len, ln, log, lower, ltrim, mod, mult, nextweekday, now, nullif, pi, position, pow, power, previousweekday, radians, rand, removeaccents, repeat, replace, round, rtrim, sign, sin, sqrt, substr, substring, subtract, sum, tan, textcat, textconstant, to_date(literal), to_localdate(literal), to_time(literal), to_timestamp(literal), to_timestamptz(literal), trim, trunc, upper, xmlquery, xpath),
        delegateanalyticfunctionslist = (avg, cume_dist, dense_rank, first_value, lag, last_value, lead, max, min, ntile, percent_rank, percentile_cont, percentile_disc, rank, row_number, sum)
    );

CHOWN admin DATASOURCE JDBC adw LASTMODIFICATIONUSER admin;

DROP DATASOURCE JDBC IF EXISTS vdpcachedatasource CASCADE;

CREATE DATASOURCE JDBC vdpcachedatasource
    DRIVERCLASSNAME = 'org.apache.derby.jdbc.ClientDriver'
    DATABASEURI = 'jdbc:derby://localhost:1527/cache'
    USERNAME = 'vdpcache'
    USERPASSWORD = 'AneKvFkfR4/3hGTNkznuPYU+2YeAVGvqJiYwkoLrNLVFe49oNj03TFMHDE08k8TR+SuGPA6K7Rmc25E9ydfv85jI5c6KU6HuqZUgWXcJIGRjoPmQVDmtmfDqEtJ60ZXf' ENCRYPTED
    CLASSPATH = 'derby-10'
    DATABASENAME = 'derby'
    DATABASEVERSION = '10'
    FETCHSIZE = 1000
    VALIDATIONQUERY = 'values 1'
    INITIALSIZE = 4
    MAXIDLE = -1
    MINIDLE = 0
    MAXACTIVE = 20
    EXHAUSTEDACTION = 1
    TESTONBORROW = true
    TESTONRETURN = false
    TESTWHILEIDLE = false
    TIMEBETWEENEVICTION = -1
    NUMTESTPEREVICTION = 3
    MINEVICTABLETIME = 1800000
    POOLPREPAREDSTATEMENTS = false
    MAXOPENPREPAREDSTATEMENTS = -1
    DATA_LOAD_CONFIGURATION (
        BATCHINSERTSIZE = 200
    );

CHOWN admin DATASOURCE JDBC vdpcachedatasource LASTMODIFICATIONUSER admin;

# #######################################
# DATABASE CONFIGURATION
# #######################################
ALTER DATABASE admin
  CHARSET DEFAULT;

ALTER DATABASE admin
  AUTHENTICATION LOCAL;

# #######################################
# WRAPPERS of admin
# #######################################
DROP WRAPPER JDBC IF EXISTS bv_fact_labor_cost_non_dollar_summary_person_expanded CASCADE;

CREATE WRAPPER JDBC bv_fact_labor_cost_non_dollar_summary_person_expanded
    FOLDER = '/2_baseviews/sqlserver/addit/adw'
    DATASOURCENAME=adw
    CATALOGNAME='ADW' 
    SCHEMANAME='dbo' 
    RELATIONNAME='vw_fact_labor_cost_non_dollar_summary_person_expanded' 
    OUTPUTSCHEMA (
        date_key = 'date_key' :'java.time.LocalDate' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='10', sourcetypeid='12', sourcetypename='date')  NOT NULL SORTABLE,
        first_day_month = 'first_day_month' :'java.time.LocalDate' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='10', sourcetypeid='12', sourcetypename='date')  NOT NULL SORTABLE,
        fiscal_year = 'fiscal_year' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  NOT NULL SORTABLE,
        fiscal_month = 'fiscal_month' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  NOT NULL SORTABLE,
        first_day_fiscal_year = 'first_day_fiscal_year' :'java.time.LocalDate' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='10', sourcetypeid='12', sourcetypename='date')  SORTABLE,
        last_day_fiscal_year = 'last_day_fiscal_year' :'java.time.LocalDate' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='10', sourcetypeid='12', sourcetypename='date')  SORTABLE,
        project_num = 'project_num' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='30', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        direct_indirect = 'direct_indirect' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='11', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        project_status_name = 'project_status_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='80', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        project_type_name = 'project_type_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='20', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        project_dept_code = 'project_dept_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='240', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        project_mission_area_code = 'project_mission_area_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='240', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        program_name = 'program_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='170', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        program_area_name = 'program_area_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='8000', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        sponsor_dept_short_name = 'sponsor_dept_short_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='240', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        sponsor_org_short_name = 'sponsor_org_short_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='240', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        contract_num = 'contract_num' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='120', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        contract_id = 'contract_id' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='25', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        project_relation = 'project_relation' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='11', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        parent_project_num = 'parent_project_num' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='10', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        work_program_name = 'work_program_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='80', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        work_program_org_code = 'work_program_org_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='20', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        account_code = 'account_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='80', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        scheduled_hour = 'scheduled_hour' :'java.lang.Long' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        available_hour = 'available_hour' :'java.lang.Long' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        person_num = 'person_num' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='12', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        full_name = 'full_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='40', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        preferred_full_name = 'preferred_full_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='40', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        person_dept_code = 'person_dept_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='20', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        person_org_code = 'person_org_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='20', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        reg_temp_ind = 'reg_temp_ind' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='1', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        person_type_code = 'person_type_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='5', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        person_status_code = 'person_status_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='1', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        full_part_ind = 'full_part_ind' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='1', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        offsite_flg = 'offsite_flg' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='1', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        origin_code = 'origin_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='2', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        actual_org_code = 'actual_org_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='20', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        actual_org_code_name = 'actual_org_code_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='123', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        actual_org_name = 'actual_org_name' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='100', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        actual_dept_code = 'actual_dept_code' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='20', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        regular_staff_year_gl = 'regular_staff_year_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_staff_year_dtk = 'regular_staff_year_dtk' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_staff_year_lt = 'regular_staff_year_lt' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_year_gl = 'overtime_staff_year_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_year_dtk = 'overtime_staff_year_dtk' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_year_lt = 'overtime_staff_year_lt' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_annualized_staff_year_gl = 'regular_annualized_staff_year_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_annualized_staff_year_gl = 'overtime_annualized_staff_year_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_staff_hour_gl = 'regular_staff_hour_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_staff_hour_dtk = 'regular_staff_hour_dtk' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_staff_hour_lt = 'regular_staff_hour_lt' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_staff_month_gl = 'regular_staff_month_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_staff_month_dtk = 'regular_staff_month_dtk' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        regular_staff_month_lt = 'regular_staff_month_lt' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_hour_gl = 'overtime_staff_hour_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_hour_dtk = 'overtime_staff_hour_dtk' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_hour_lt = 'overtime_staff_hour_lt' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_month_gl = 'overtime_staff_month_gl' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_month_dtk = 'overtime_staff_month_dtk' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        overtime_staff_month_lt = 'overtime_staff_month_lt' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='16', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='2', sourcetypename='numeric')  SORTABLE,
        account_code_rollup = 'account_rollup' :'java.lang.String' (OPT) (sourcetypedecimals='0', sourcetyperadix='0', sourcetypesize='80', sourcetypeid='12', sourcetypename='varchar')  SORTABLE
    );

CHOWN admin WRAPPER JDBC bv_fact_labor_cost_non_dollar_summary_person_expanded LASTMODIFICATIONUSER admin;

# #######################################
# STORED PROCEDURES of admin
# #######################################
# No stored procedures in database admin
# #######################################
# TYPES of admin
# #######################################
# No types in database admin
# #######################################
# MAPS of admin
# #######################################
# No maps in database admin
# #######################################
# BASE VIEWS of admin
# #######################################
DROP VIEW IF EXISTS bv_vw_fact_labor_cost_non_dollar_summary_person_expanded CASCADE;

CREATE TABLE bv_vw_fact_labor_cost_non_dollar_summary_person_expanded I18N us_est (
        date_key:localdate (sourcetypeid = '91', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '10', description = 'Reference dim_date'),
        first_day_month:localdate (sourcetypeid = '91', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '10', description = 'First day of the month of the date in the format of YYYY-MM-DD (e.g., 2020-01-01)'),
        fiscal_year:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10', description = 'Fiscal year (October - September) in the format of YYYY (e.g., 2020: when date is between 2019-10-01 and 2020-09-30).'),
        fiscal_month:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10', description = 'Ordinal number indicating the month in the fiscal year (October - September) (e.g., 1: when date is in October).'),
        first_day_fiscal_year:localdate (sourcetypeid = '91', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '10', description = 'First day of the fiscal year (October - September) in the format of YYYY-MM-DD (e.g., 2020-10-01)'),
        last_day_fiscal_year:localdate (sourcetypeid = '91', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '10', description = 'Last day of the fiscal year (October - September) in the format of YYYY-MM-DD (e.g., 2021-09-30)'),
        project_num:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '30', description = 'It identifies a project (5-characters). It also called subtask_id or task_id in legacy system.'),
        direct_indirect:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '11', description = 'Direct or indirect project indicator: Direct, Indirect, Unspecified'),
        project_status_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '80', description = 'Project status (e.g., PENDING, ACTIVE, CLOSED OUT, COMPLETE)'),
        project_type_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '20', description = 'Project type (e.g., Contract, Grant)'),
        project_dept_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '240', description = 'A code to identify a department or sector that owns the project (e.g., AMDS, AOS).'),
        project_mission_area_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '240', description = 'A code to identify a project mission area (e.g., CO, CS, HP).'),
        program_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '170', description = 'Name of the project program (e.g. ADVANCED SCIENCE & TECHNOLOGY DEVELOPMENT, HEALTH SURVEILLANCE)'),
        program_area_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '8000', description = 'Project program area (e.g. INTEGRATED WARFARE SYSTEMS, RESEARCH & APPLICATIONS)'),
        sponsor_dept_short_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '240', description = 'Sponsor department short name (e.g. NAVAIR, USAFA)'),
        sponsor_org_short_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '240', description = 'Sponsor organization short name (e.g. NAVY, AIR FORCE)'),
        contract_num:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '120', description = 'Contract number. It applies to direct project.'),
        contract_id:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '25', description = 'APL designated short name assigned to a contract. It applies to direct project.'),
        project_relation:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '11', description = 'A code to identify project relationship: C (child), S (standalone), P (parent).'),
        parent_project_num:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '10', description = 'Parent project number'),
        work_program_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '80', description = 'Work program name.  A base work program name is 8-character long.'),
        work_program_org_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '20', description = 'A code to identify an owning organization of a work program.'),
        account_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '80', description = 'A code to identify a cost account (e.g., On_Lbr_S1_Reg)'),
        account_code_rollup:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '80', description = 'A code to identify a top level or level 2 cost account in an account hierarchical category for PMR reporting'),
        scheduled_hour:long (sourcetypeid = '-5', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10', description = 'Total number of hours scheduled for a month of a fiscal year'),
        available_hour:long (sourcetypeid = '-5', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10', description = 'Total number of hours available for a month of a fiscal year'),
        person_num:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '12', description = 'An unique number assigned to a person by APL (aka employee id)'),
        full_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '40', description = 'Full name of a person displayed in Outlook.'),
        preferred_full_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '40', description = 'Person preferred name.'),
        person_dept_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '20', description = 'A code to identify a department organization'),
        person_org_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '20', description = 'A code to identify an APL HR organization'),
        reg_temp_ind:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '1', description = 'It indicates that a person is regular or temporary employee (e.g. T, R).'),
        person_type_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '5', description = 'A code to specify a person type (e.g. RSE, OAS, APLR, OSNE, FCU, APL).  It is derived from person_subtype_code.'),
        person_status_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '1', description = 'A code to specify a status of a person (e.g. A = Active, I = Inactive)'),
        full_part_ind:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '1', description = 'It indicates that a person is part-time or full-time employee (e.g. F = Full-time, P = Part-time)'),
        offsite_flg:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '1', description = 'It flags whether a person is offsite or not.'),
        origin_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '2', description = 'A code to specify where the cost data came from (e.g., DW, GL, LD, LT, TK)'),
        actual_org_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '20', description = 'A code to identify an APL HR organization.'),
        actual_org_code_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '123', description = 'Org Code + ''-'' + Org Name'),
        actual_org_name:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '100', description = 'APL HR organization name.'),
        actual_dept_code:text (sourcetypeid = '12', sourcetyperadix = '0', sourcetypedecimals = '0', sourcetypesize = '20', description = 'A code to identify a department organization'),
        regular_staff_year_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) processed through the General Ledger for a closed pay period converted to Staff Years by dividing by the number of productive hours for a Fiscal Year (1810).  This data is sourced from the Data Warehouse and occurs approximately mid month and at month end.'),
        regular_staff_year_dtk:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) recorded and saved in Etime by 6:30pm that day for an open pay period converted to Staff Years by dividing by the number of productive hours for a Fiscal Year (1810).  This data is sourced from the Data Warehouse on a nightly basis.'),
        regular_staff_year_lt:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) associated with a time card that has not been submitted and approved by 7pm Tuesday following the end of a pay period converted to Staff Years by dividing by the number of productive hours for a Fiscal Year (1810).  This data is sourced from the Data Warehouse on a nightly basis.'),
        overtime_staff_year_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Overtime hours processed through the General Ledger for a closed pay period converted to Staff Years by dividing by the number of productive hours for a Fiscal Year (1810).  This data is sourced from the Data Warehouse and occurs approximately mid month and at month end.'),
        overtime_staff_year_dtk:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Overtime hours recorded and saved in Etime by 6:30pm that day for an open pay period converted to Staff Years by dividing by the number of productive hours for a Fiscal Year (1810).  This data is sourced from the Data Warehouse on a nightly basis.'),
        overtime_staff_year_lt:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Overtime hours associated with a time card that has not been submitted and approved by 7pm Tuesday following the end of a pay period converted to Staff Years by dividing by the number of productive hours for a Fiscal Year (1810).  This data is sourced from the Data Warehouse on a nightly basis.'),
        regular_annualized_staff_year_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Actual regualr hours worked for a pay period (Etime) that have been normalized to an 80 hour pay period and then summed through the closed month.  Hours then converted to Annualized Staff Years by dividing by the total number of productive hours up to the closed month as defined by the accounting calendar both sourced from the Data Warehouse. Includes both APL and LW hours.'),
        overtime_annualized_staff_year_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Actual overtime hours worked for a pay period (Etime) summed through the closed month that are converted to Annualized Staff Years by dividing by the total number productive hours up to the closed month as defined by the accounting calendar both sourced from the Data Warehouse. Includes both APL and LW hours.'),
        regular_staff_hour_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) processed through the General Ledger for a closed pay period.  This data is sourced from the Data Warehouse and occurs approximately mid month and at month end.'),
        regular_staff_hour_dtk:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) associated with a time card that has not been submitted and approved by 7pm Tuesday following the end of a pay period.  This data is sourced from the Data Warehouse on a nightly basis.'),
        regular_staff_hour_lt:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) recorded and saved in Etime by 6:30pm that day for an open pay period.  This data is sourced from the Data Warehouse on a nightly basis.'),
        regular_staff_month_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) processed through the General Ledger for a closed pay period converted to Staff Months by dividing by the number of productive hours for that month.  This data is sourced from the Data Warehouse and occurs approximately mid month and at month end.'),
        regular_staff_month_dtk:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) recorded and saved in Etime by 6:30pm that day for an open pay period converted to Staff Months by dividing by the number of productive hours for that month.  This data is sourced from the Data Warehouse on a nightly basis.'),
        regular_staff_month_lt:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) associated with a time card that has not been submitted and approved by 7pm Tuesday following the end of a pay period converted to Staff Months by dividing by the number of productive hours for that month.  This data is sourced from the Data Warehouse on a nightly basis.'),
        overtime_staff_hour_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Overtime hours processed through the General Ledger for a closed pay period.  This data is sourced from the Data Warehouse and occurs approximately mid month and at month end.'),
        overtime_staff_hour_dtk:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Overtime hours recorded and saved in Etime by 6:30pm that day for an open pay period.  This data is sourced from the Data Warehouse on a nightly basis.'),
        overtime_staff_hour_lt:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Regular hours (normalized back to 80 hours when a staff members'' timesheet exceeds 80 hours) associated with a time card that has not been submitted and approved by 7pm Tuesday following the end of a pay period.  This data is sourced from the Data Warehouse on a nightly basis.'),
        overtime_staff_month_gl:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Overtime hours processed through the General Ledger for a closed pay period converted to Staff Months by dividing by the number of productive hours for that month.  This data is sourced from the Data Warehouse and occurs approximately mid month and at month end.'),
        overtime_staff_month_dtk:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Overtime hours recorded and saved in Etime by 6:30pm that day for an open pay period converted to Staff Months by dividing by the number of productive hours for that month.  This data is sourced from the Data Warehouse on a nightly basis.'),
        overtime_staff_month_lt:decimal (sourcetypeid = '2', sourcetyperadix = '10', sourcetypedecimals = '16', sourcetypesize = '38', description = 'Overtime hours associated with a time card that has not been submitted and approved by 7pm Tuesday following the end of a pay period converted to Staff Months by dividing by the number of productive hours for that month.  This data is sourced from the Data Warehouse on a nightly basis.')
    )
    FOLDER = '/2_baseviews/sqlserver/addit/adw'
    DESCRIPTION = 'Purpose: ADW base view for vw_fact_labor_cost_non_dollar_summary_person_expanded

Author:    J.Grepps
Date:     04/14/22

Revisions:
Author			Date		Comments
--------------------   -------------	-------------------------------------------------------------------------------------------------------'
    CACHE OFF
    TIMETOLIVEINCACHE DEFAULT
    ADD SEARCHMETHOD bv_fact_labor_cost_non_dollar_summary_person_expanded(
        I18N us_est
        CONSTRAINTS (
             ADD date_key (any) OPT ANY
             ADD first_day_month (any) OPT ANY
             ADD fiscal_year (any) OPT ANY
             ADD fiscal_month (any) OPT ANY
             ADD first_day_fiscal_year (any) OPT ANY
             ADD last_day_fiscal_year (any) OPT ANY
             ADD project_num (any) OPT ANY
             ADD direct_indirect (any) OPT ANY
             ADD project_status_name (any) OPT ANY
             ADD project_type_name (any) OPT ANY
             ADD project_dept_code (any) OPT ANY
             ADD project_mission_area_code (any) OPT ANY
             ADD program_name (any) OPT ANY
             ADD program_area_name (any) OPT ANY
             ADD sponsor_dept_short_name (any) OPT ANY
             ADD sponsor_org_short_name (any) OPT ANY
             ADD contract_num (any) OPT ANY
             ADD contract_id (any) OPT ANY
             ADD project_relation (any) OPT ANY
             ADD parent_project_num (any) OPT ANY
             ADD work_program_name (any) OPT ANY
             ADD work_program_org_code (any) OPT ANY
             ADD account_code (any) OPT ANY
             ADD account_code_rollup (any) OPT ANY
             ADD scheduled_hour (any) OPT ANY
             ADD available_hour (any) OPT ANY
             ADD person_num (any) OPT ANY
             ADD full_name (any) OPT ANY
             ADD preferred_full_name (any) OPT ANY
             ADD person_dept_code (any) OPT ANY
             ADD person_org_code (any) OPT ANY
             ADD reg_temp_ind (any) OPT ANY
             ADD person_type_code (any) OPT ANY
             ADD person_status_code (any) OPT ANY
             ADD full_part_ind (any) OPT ANY
             ADD offsite_flg (any) OPT ANY
             ADD origin_code (any) OPT ANY
             ADD actual_org_code (any) OPT ANY
             ADD actual_org_code_name (any) OPT ANY
             ADD actual_org_name (any) OPT ANY
             ADD actual_dept_code (any) OPT ANY
             ADD regular_staff_year_gl (any) OPT ANY
             ADD regular_staff_year_dtk (any) OPT ANY
             ADD regular_staff_year_lt (any) OPT ANY
             ADD overtime_staff_year_gl (any) OPT ANY
             ADD overtime_staff_year_dtk (any) OPT ANY
             ADD overtime_staff_year_lt (any) OPT ANY
             ADD regular_annualized_staff_year_gl (any) OPT ANY
             ADD overtime_annualized_staff_year_gl (any) OPT ANY
             ADD regular_staff_hour_gl (any) OPT ANY
             ADD regular_staff_hour_dtk (any) OPT ANY
             ADD regular_staff_hour_lt (any) OPT ANY
             ADD regular_staff_month_gl (any) OPT ANY
             ADD regular_staff_month_dtk (any) OPT ANY
             ADD regular_staff_month_lt (any) OPT ANY
             ADD overtime_staff_hour_gl (any) OPT ANY
             ADD overtime_staff_hour_dtk (any) OPT ANY
             ADD overtime_staff_hour_lt (any) OPT ANY
             ADD overtime_staff_month_gl (any) OPT ANY
             ADD overtime_staff_month_dtk (any) OPT ANY
             ADD overtime_staff_month_lt (any) OPT ANY
        )
        OUTPUTLIST (account_code, account_code_rollup, actual_dept_code, actual_org_code, actual_org_code_name, actual_org_name, available_hour, contract_id, contract_num, date_key, direct_indirect, first_day_fiscal_year, first_day_month, fiscal_month, fiscal_year, full_name, full_part_ind, last_day_fiscal_year, offsite_flg, origin_code, overtime_annualized_staff_year_gl, overtime_staff_hour_dtk, overtime_staff_hour_gl, overtime_staff_hour_lt, overtime_staff_month_dtk, overtime_staff_month_gl, overtime_staff_month_lt, overtime_staff_year_dtk, overtime_staff_year_gl, overtime_staff_year_lt, parent_project_num, person_dept_code, person_num, person_org_code, person_status_code, person_type_code, preferred_full_name, program_area_name, program_name, project_dept_code, project_mission_area_code, project_num, project_relation, project_status_name, project_type_name, reg_temp_ind, regular_annualized_staff_year_gl, regular_staff_hour_dtk, regular_staff_hour_gl, regular_staff_hour_lt, regular_staff_month_dtk, regular_staff_month_gl, regular_staff_month_lt, regular_staff_year_dtk, regular_staff_year_gl, regular_staff_year_lt, scheduled_hour, sponsor_dept_short_name, sponsor_org_short_name, work_program_name, work_program_org_code
        )
        WRAPPER (jdbc bv_fact_labor_cost_non_dollar_summary_person_expanded)
    );

CHOWN admin VIEW bv_vw_fact_labor_cost_non_dollar_summary_person_expanded LASTMODIFICATIONUSER admin;

# #######################################
# VIEWS of admin
# #######################################
DROP VIEW IF EXISTS bv_test CASCADE;

CREATE VIEW bv_test AS SELECT 'test1' AS test_txt, current_date() AS today FROM dual();

CHOWN admin VIEW bv_test LASTMODIFICATIONUSER admin;

DROP VIEW IF EXISTS dv_fact_labor_cost_non_dollar_summary_person_expanded CASCADE;

CREATE VIEW dv_fact_labor_cost_non_dollar_summary_person_expanded FOLDER = '/3_derivedviews/facts' DESCRIPTION = 'Purpose: Denormalized version of the vw_fact_labor_cost_non_dollar_summary_person view

Author:    B.Garrett
Date:     09/24/20

Revisions:
Author     Date        Comments
--------------------   ----------------  -------------------------------------------------------------------------------------------------------
J. Grepps	04/14/22	Due to performance issues and new ADW was created.  This change is to swap out the join and pull data directly from the new ADW view.'  AS SELECT bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.date_key AS date_key, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.first_day_month AS first_day_month, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.fiscal_year AS fiscal_year, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.fiscal_month AS fiscal_month, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.first_day_fiscal_year AS first_day_fiscal_year, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.last_day_fiscal_year AS last_day_fiscal_year, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.project_num AS project_num, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.direct_indirect AS direct_indirect, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.project_status_name AS project_status_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.project_type_name AS project_type_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.project_dept_code AS project_dept_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.project_mission_area_code AS project_mission_area_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.program_name AS program_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.program_area_name AS program_area_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.sponsor_dept_short_name AS sponsor_dept_short_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.sponsor_org_short_name AS sponsor_org_short_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.contract_num AS contract_num, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.contract_id AS contract_id, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.project_relation AS project_relation, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.parent_project_num AS parent_project_num, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.work_program_name AS work_program_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.work_program_org_code AS work_program_org_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.account_code AS account_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.account_code_rollup AS account_code_rollup, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.scheduled_hour AS scheduled_hour, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.available_hour AS available_hour, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.person_num AS person_num, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.full_name AS full_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.preferred_full_name AS preferred_full_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.person_dept_code AS person_dept_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.person_org_code AS person_org_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.reg_temp_ind AS reg_temp_ind, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.person_type_code AS person_type_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.person_status_code AS person_status_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.full_part_ind AS full_part_ind, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.offsite_flg AS offsite_flg, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.origin_code AS origin_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.actual_org_code AS actual_org_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.actual_org_code_name AS actual_org_code_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.actual_org_name AS actual_org_name, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.actual_dept_code AS actual_dept_code, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_year_gl AS regular_staff_year_gl, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_year_dtk AS regular_staff_year_dtk, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_year_lt AS regular_staff_year_lt, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_year_gl AS overtime_staff_year_gl, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_year_dtk AS overtime_staff_year_dtk, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_year_lt AS overtime_staff_year_lt, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_annualized_staff_year_gl AS regular_annualized_staff_year_gl, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_annualized_staff_year_gl AS overtime_annualized_staff_year_gl, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_hour_gl AS regular_staff_hour_gl, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_hour_dtk AS regular_staff_hour_dtk, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_hour_lt AS regular_staff_hour_lt, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_month_gl AS regular_staff_month_gl, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_month_dtk AS regular_staff_month_dtk, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_month_lt AS regular_staff_month_lt, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_hour_gl AS overtime_staff_hour_gl, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_hour_dtk AS overtime_staff_hour_dtk, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_hour_lt AS overtime_staff_hour_lt, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_month_gl AS overtime_staff_month_gl, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_month_dtk AS overtime_staff_month_dtk, bv_vw_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_month_lt AS overtime_staff_month_lt FROM bv_vw_fact_labor_cost_non_dollar_summary_person_expanded;

CHOWN admin VIEW dv_fact_labor_cost_non_dollar_summary_person_expanded LASTMODIFICATIONUSER admin;

ALTER VIEW dv_fact_labor_cost_non_dollar_summary_person_expanded
 LAYOUT (bv_vw_fact_labor_cost_non_dollar_summary_person_expanded = [20, 20, 424, 789]);

DROP VIEW IF EXISTS impl_fact_labor_cost_non_dollar_summary_person_expanded CASCADE;

CREATE VIEW impl_fact_labor_cost_non_dollar_summary_person_expanded FOLDER = '/4_implementationviews/facts' DESCRIPTION = 'Purpose: Implementation view of the dv_fact_labor_cost_non_dollar_summary_person_extended view

Author:    B.Garrett
Date:     09/24/20

Revisions:
Author     Date        Comments
--------------------   ----------------  -------------------------------------------------------------------------------------------------------'  AS SELECT dv_fact_labor_cost_non_dollar_summary_person_expanded.date_key AS date_key, dv_fact_labor_cost_non_dollar_summary_person_expanded.first_day_month AS first_day_month, dv_fact_labor_cost_non_dollar_summary_person_expanded.fiscal_year AS fiscal_year, dv_fact_labor_cost_non_dollar_summary_person_expanded.fiscal_month AS fiscal_month, dv_fact_labor_cost_non_dollar_summary_person_expanded.first_day_fiscal_year AS first_day_fiscal_year, dv_fact_labor_cost_non_dollar_summary_person_expanded.last_day_fiscal_year AS last_day_fiscal_year, dv_fact_labor_cost_non_dollar_summary_person_expanded.project_num AS project_num, dv_fact_labor_cost_non_dollar_summary_person_expanded.direct_indirect AS direct_indirect, dv_fact_labor_cost_non_dollar_summary_person_expanded.project_status_name AS project_status_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.project_type_name AS project_type_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.project_dept_code AS project_dept_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.project_mission_area_code AS project_mission_area_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.program_name AS program_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.program_area_name AS program_area_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.sponsor_dept_short_name AS sponsor_dept_short_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.sponsor_org_short_name AS sponsor_org_short_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.contract_num AS contract_num, dv_fact_labor_cost_non_dollar_summary_person_expanded.contract_id AS contract_id, dv_fact_labor_cost_non_dollar_summary_person_expanded.project_relation AS project_relation, dv_fact_labor_cost_non_dollar_summary_person_expanded.parent_project_num AS parent_project_num, dv_fact_labor_cost_non_dollar_summary_person_expanded.work_program_name AS work_program_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.work_program_org_code AS work_program_org_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.account_code AS account_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.account_code_rollup AS account_code_rollup, dv_fact_labor_cost_non_dollar_summary_person_expanded.scheduled_hour AS scheduled_hour, dv_fact_labor_cost_non_dollar_summary_person_expanded.available_hour AS available_hour, dv_fact_labor_cost_non_dollar_summary_person_expanded.person_num AS person_num, dv_fact_labor_cost_non_dollar_summary_person_expanded.full_name AS full_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.preferred_full_name AS preferred_full_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.person_dept_code AS person_dept_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.person_org_code AS person_org_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.reg_temp_ind AS reg_temp_ind, dv_fact_labor_cost_non_dollar_summary_person_expanded.person_type_code AS person_type_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.person_status_code AS person_status_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.full_part_ind AS full_part_ind, dv_fact_labor_cost_non_dollar_summary_person_expanded.offsite_flg AS offsite_flg, dv_fact_labor_cost_non_dollar_summary_person_expanded.origin_code AS origin_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.actual_org_code AS actual_org_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.actual_org_code_name AS actual_org_code_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.actual_org_name AS actual_org_name, dv_fact_labor_cost_non_dollar_summary_person_expanded.actual_dept_code AS actual_dept_code, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_year_gl AS regular_staff_year_gl, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_year_dtk AS regular_staff_year_dtk, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_year_lt AS regular_staff_year_lt, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_year_gl AS overtime_staff_year_gl, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_year_dtk AS overtime_staff_year_dtk, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_year_lt AS overtime_staff_year_lt, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_annualized_staff_year_gl AS regular_annualized_staff_year_gl, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_annualized_staff_year_gl AS overtime_annualized_staff_year_gl, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_hour_gl AS regular_staff_hour_gl, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_hour_dtk AS regular_staff_hour_dtk, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_hour_lt AS regular_staff_hour_lt, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_month_gl AS regular_staff_month_gl, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_month_dtk AS regular_staff_month_dtk, dv_fact_labor_cost_non_dollar_summary_person_expanded.regular_staff_month_lt AS regular_staff_month_lt, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_hour_gl AS overtime_staff_hour_gl, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_hour_dtk AS overtime_staff_hour_dtk, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_hour_lt AS overtime_staff_hour_lt, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_month_gl AS overtime_staff_month_gl, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_month_dtk AS overtime_staff_month_dtk, dv_fact_labor_cost_non_dollar_summary_person_expanded.overtime_staff_month_lt AS overtime_staff_month_lt FROM dv_fact_labor_cost_non_dollar_summary_person_expanded;

CHOWN admin VIEW impl_fact_labor_cost_non_dollar_summary_person_expanded LASTMODIFICATIONUSER admin;

ALTER VIEW impl_fact_labor_cost_non_dollar_summary_person_expanded
 LAYOUT (dv_fact_labor_cost_non_dollar_summary_person_expanded = [20, 20, 431, 792]);

# #######################################
# ASSOCIATIONS of admin
# #######################################
# No associations in database admin
# #######################################
# WEBSERVICES of admin
# #######################################
# No web services in database admin
# #######################################
# WIDGETS of admin
# #######################################
# No widgets in database admin
# #######################################
# WEBCONTAINER WEB SERVICE DEPLOYMENTS of admin
# #######################################
# No deployed web services in database admin
# #######################################
# WEBCONTAINER WIDGET DEPLOYMENTS of admin
# #######################################
# No deployed widgets in database admin
# #######################################
# VIEW STATISTICS of admin
# #######################################
# No statistics in database admin
# #######################################
# Closing connection with database admin
# #######################################
CLOSE;


# 3 ====================================================================

# #######################################
# DATABASE of db_gsc
# #######################################
DROP DATABASE IF EXISTS db_gsc;

CREATE DATABASE db_gsc '';

CONNECT DATABASE db_gsc;

# #######################################
# LISTENERS JMS of db_gsc
# #######################################
# No listeners jms in database db_gsc
# #######################################
# LISTENERS KAFKA of db_gsc
# #######################################
# No listeners kafka in database db_gsc
# #######################################
# DATASOURCES of db_gsc
# #######################################
DROP DATASOURCE JDBC IF EXISTS ds_oracle CASCADE;

CREATE DATASOURCE JDBC ds_oracle
    DRIVERCLASSNAME = 'oracle.jdbc.OracleDriver'
    DATABASEURI = 'jdbc:oracle:thin:@data-server:1521/xe'
    USERNAME = 'crm'
    USERPASSWORD = 'jJG6SDnAg+YLrCmfgb6Kx8BB8pMH6GrfTdwWtI8esRw8dE5pjv7mdtDPa4sfwmjCj8Qj7dPVBk0siVC215lFLjXSX05o4gEhX9zkWRpr1/OL2T2gD+PjGeAlxXoPzR2j' ENCRYPTED
    CLASSPATH = 'oracle-11g'
    DATABASENAME = 'oracle'
    DATABASEVERSION = '11g'
    FETCHSIZE = 1000
    VALIDATIONQUERY = 'SELECT COUNT(*) FROM SYS.DUAL'
    INITIALSIZE = 4
    MAXIDLE = -1
    MINIDLE = 0
    MAXACTIVE = 20
    EXHAUSTEDACTION = 1
    TESTONBORROW = true
    TESTONRETURN = false
    TESTWHILEIDLE = false
    TIMEBETWEENEVICTION = -1
    NUMTESTPEREVICTION = 3
    MINEVICTABLETIME = 1800000
    POOLPREPAREDSTATEMENTS = false
    MAXOPENPREPAREDSTATEMENTS = -1
    PROPERTIES ('remarksReporting'='false', 'includeSynonyms'='false')
    DATA_LOAD_CONFIGURATION (
        BATCHINSERTSIZE = 200
    );

CHOWN admin DATASOURCE JDBC ds_oracle LASTMODIFICATIONUSER admin;

DROP DATASOURCE JDBC IF EXISTS ds_sql CASCADE;

CREATE DATASOURCE JDBC ds_sql
    DRIVERCLASSNAME = 'com.microsoft.sqlserver.jdbc.SQLServerDriver'
    DATABASEURI = 'jdbc:sqlserver://localhost:1433;databaseName=CollegeInformation;encrypt=false'
    USERNAME = 'sa'
    USERPASSWORD = 'AwLwtAlgZ4PPSlK2u5Gq/0KFe1heeDTyYAMT9rO8RQoa0OY497l+2yzx6pV0yJYwmChwVNQYj2NX0OmghLRS0nWa403tzvcl6C+QuBZbo7EQ8MTVUlT0Ap4sPgk1mqw8' ENCRYPTED
    CLASSPATH = 'mssql-jdbc-10.x'
    DATABASENAME = 'sqlserver'
    DATABASEVERSION = '2017'
    FETCHSIZE = 1000
    VALIDATIONQUERY = 'Select 1'
    INITIALSIZE = 4
    MAXIDLE = -1
    MINIDLE = 0
    MAXACTIVE = 20
    EXHAUSTEDACTION = 1
    TESTONBORROW = true
    TESTONRETURN = false
    TESTWHILEIDLE = false
    TIMEBETWEENEVICTION = -1
    NUMTESTPEREVICTION = 3
    MINEVICTABLETIME = 1800000
    POOLPREPAREDSTATEMENTS = false
    MAXOPENPREPAREDSTATEMENTS = -1
    DATA_LOAD_CONFIGURATION (
        BATCHINSERTSIZE = 1000
    );

CHOWN admin DATASOURCE JDBC ds_sql LASTMODIFICATIONUSER admin;

# #######################################
# DATABASE CONFIGURATION
# #######################################
ALTER DATABASE db_gsc
  CHARSET DEFAULT;

# #######################################
# WRAPPERS of db_gsc
# #######################################
DROP WRAPPER JDBC IF EXISTS bv_chs CASCADE;

CREATE WRAPPER JDBC bv_chs
    DATASOURCENAME=ds_sql
    CATALOGNAME='CollegeInformation' 
    SCHEMANAME='dbo' 
    RELATIONNAME='bv_chs' 
    OUTPUTSCHEMA (
        id = 'id' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  SORTABLE,
        name = 'name' :'java.lang.String' (OPT) (sourcetypesize='50', sourcetypeid='12', sourcetypename='varchar')  SORTABLE
    );

CHOWN admin WRAPPER JDBC bv_chs LASTMODIFICATIONUSER admin;

DROP WRAPPER JDBC IF EXISTS bv_ho_orders CASCADE;

CREATE WRAPPER JDBC bv_ho_orders
    DATASOURCENAME=ds_oracle
    SCHEMANAME='HUMAN_RESOURCES' 
    RELATIONNAME='BV_HO_ORDERS' 
    OUTPUTSCHEMA (
        id = 'ID' :'java.math.BigDecimal' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='38', sourcetypeid='3', sourcetypename='NUMBER')  SORTABLE,
        customer_code = 'CUSTOMER_CODE' :'java.lang.String' (OPT) (sourcetyperadix='10', sourcetypesize='2650', sourcetypeid='12', sourcetypename='VARCHAR2')  SORTABLE,
        status = 'STATUS' :'java.lang.String' (OPT) (sourcetyperadix='10', sourcetypesize='50', sourcetypeid='12', sourcetypename='VARCHAR2')  SORTABLE,
        dateplaced = 'DATEPLACED' :'java.time.LocalDateTime' (OPT) (sourcetypedecimals='6', sourcetyperadix='10', sourcetypesize='11', sourcetypeid='93', sourcetypename='TIMESTAMP(6)')  SORTABLE,
        datedelivered = 'DATEDELIVERED' :'java.time.LocalDateTime' (OPT) (sourcetypedecimals='6', sourcetyperadix='10', sourcetypesize='11', sourcetypeid='93', sourcetypename='TIMESTAMP(6)')  SORTABLE,
        dateclosed = 'DATECLOSED' :'java.time.LocalDateTime' (OPT) (sourcetypedecimals='6', sourcetyperadix='10', sourcetypesize='11', sourcetypeid='93', sourcetypename='TIMESTAMP(6)')  SORTABLE
    );

CHOWN admin WRAPPER JDBC bv_ho_orders LASTMODIFICATIONUSER admin;

DROP WRAPPER JDBC IF EXISTS coursedetails CASCADE;

CREATE WRAPPER JDBC coursedetails
    DATASOURCENAME=ds_sql
    CATALOGNAME='CollegeInformation' 
    SCHEMANAME='dbo' 
    RELATIONNAME='Coursedetails' 
    OUTPUTSCHEMA (
        coursecode = 'CourseCode' :'java.lang.String' (OPT) (sourcetypesize='4', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        coursename = 'CourseName' :'java.lang.String' (OPT) (sourcetypesize='50', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        year = 'Year' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  ESCAPE SORTABLE,
        coursedurationinhrs = 'CourseDurationInhrs' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  SORTABLE,
        teacher = 'Teacher' :'java.lang.String' (OPT) (sourcetypesize='50', sourcetypeid='12', sourcetypename='varchar')  NOT NULL SORTABLE,
        objectives = 'Objectives' :'java.lang.String' (OPT) (sourcetypesize='2147483647', sourcetypeid='-1', sourcetypename='text')  SORTABLE,
        semester = 'Semester' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  SORTABLE,
        writtenexam = 'WrittenExam' :'java.lang.Boolean' (OPT) (sourcetypesize='1', sourcetypeid='-7', sourcetypename='bit')  SORTABLE,
        oralexam = 'OralExam' :'java.lang.Boolean' (OPT) (sourcetypesize='1', sourcetypeid='-7', sourcetypename='bit')  SORTABLE,
        last_modified_date = 'last_modified_date' :'java.time.LocalDate' (OPT) (sourcetypedecimals='0', sourcetypesize='10', sourcetypeid='91', sourcetypename='date')  SORTABLE
    )
    CONSTRAINT 'pk_coursecode' PRIMARY KEY ( 'CourseCode' )
    INDEX 'pk_coursecode' CLUSTER UNIQUE PRIMARY ( 'CourseCode' );

CHOWN admin WRAPPER JDBC coursedetails LASTMODIFICATIONUSER admin;

DROP WRAPPER JDBC IF EXISTS rt_coursedetails CASCADE;

CREATE WRAPPER JDBC rt_coursedetails
    DATASOURCENAME=ds_sql
    CATALOGNAME='CollegeInformation' 
    SCHEMANAME='dbo' 
    RELATIONNAME='rt_coursedetails' 
    OUTPUTSCHEMA (
        coursecode = 'coursecode' :'java.lang.String' (OPT) (sourcetypesize='4', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        coursename = 'coursename' :'java.lang.String' (OPT) (sourcetypesize='50', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        year = 'field_0' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  SORTABLE,
        coursedurationinhrs = 'coursedurationinhrs' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  SORTABLE,
        teacher = 'teacher' :'java.lang.String' (OPT) (sourcetypesize='50', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        objectives = 'objectives' :'java.lang.String' (OPT) (sourcetypesize='2147483647', sourcetypeid='12', sourcetypename='varchar')  SORTABLE,
        semester = 'semester' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  SORTABLE,
        writtenexam = 'writtenexam' :'java.lang.Boolean' (OPT) (sourcetypesize='1', sourcetypeid='-7', sourcetypename='bit')  SORTABLE,
        oralexam = 'oralexam' :'java.lang.Boolean' (OPT) (sourcetypesize='1', sourcetypeid='-7', sourcetypename='bit')  SORTABLE,
        last_modified_date = 'last_modified_date' :'java.time.LocalDate' (OPT) (sourcetypedecimals='0', sourcetypesize='10', sourcetypeid='91', sourcetypename='date')  SORTABLE
    );

CHOWN admin WRAPPER JDBC rt_coursedetails LASTMODIFICATIONUSER admin;

DROP WRAPPER JDBC IF EXISTS sql_demo_1 CASCADE;

CREATE WRAPPER JDBC sql_demo_1
    DATASOURCENAME=ds_sql
    CATALOGNAME='CollegeInformation' 
    SCHEMANAME='dbo' 
    RELATIONNAME='sql_demo_1' 
    OUTPUTSCHEMA (
        last = 'last' :'java.lang.String' (OPT) (sourcetypesize='2147483647', sourcetypeid='-1', sourcetypename='text')  ESCAPE SORTABLE,
        first = 'first' :'java.lang.String' (OPT) (sourcetypesize='2147483647', sourcetypeid='-1', sourcetypename='text')  ESCAPE SORTABLE,
        birthdate = 'birthdate' :'java.sql.Blob' (OPT) (sourcetypesize='8', sourcetypeid='-2', sourcetypename='timestamp')  SORTABLE,
        birthdate1 = 'birthdate1' :'java.time.LocalDateTime' (OPT) (sourcetypedecimals='3', sourcetypesize='23', sourcetypeid='93', sourcetypename='datetime')  SORTABLE,
        num = 'num' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  SORTABLE
    );

CHOWN admin WRAPPER JDBC sql_demo_1 LASTMODIFICATIONUSER admin;

DROP WRAPPER JDBC IF EXISTS sql_demo_2 CASCADE;

CREATE WRAPPER JDBC sql_demo_2
    DATASOURCENAME=ds_sql
    CATALOGNAME='CollegeInformation' 
    SCHEMANAME='dbo' 
    RELATIONNAME='sql_demo_2' 
    OUTPUTSCHEMA (
        name = 'name' :'java.lang.String' (OPT) (sourcetypesize='10', sourcetypeid='-15', sourcetypename='nchar')  SORTABLE,
        birthdate = 'birthdate' :'java.time.LocalDateTime' (OPT) (sourcetypedecimals='3', sourcetypesize='23', sourcetypeid='93', sourcetypename='datetime')  SORTABLE,
        first = 'first' :'java.lang.String' (OPT) (sourcetypesize='2147483647', sourcetypeid='-1', sourcetypename='text')  ESCAPE SORTABLE,
        last = 'last' :'java.lang.String' (OPT) (sourcetypesize='2147483647', sourcetypeid='-1', sourcetypename='text')  ESCAPE SORTABLE,
        num2 = 'num2' :'java.lang.Integer' (OPT) (sourcetypedecimals='0', sourcetyperadix='10', sourcetypesize='10', sourcetypeid='4', sourcetypename='int')  SORTABLE
    );

CHOWN admin WRAPPER JDBC sql_demo_2 LASTMODIFICATIONUSER admin;

# #######################################
# STORED PROCEDURES of db_gsc
# #######################################
# No stored procedures in database db_gsc
# #######################################
# TYPES of db_gsc
# #######################################
# No types in database db_gsc
# #######################################
# MAPS of db_gsc
# #######################################
# No maps in database db_gsc
# #######################################
# BASE VIEWS of db_gsc
# #######################################
DROP VIEW IF EXISTS bv_chs CASCADE;

CREATE TABLE bv_chs I18N au_cst (
        id:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10'),
        name:text (sourcetypeid = '12', sourcetypesize = '50')
    )
    CACHE FULL
    BATCHSIZEINCACHE DEFAULT
    TIMETOLIVEINCACHE DEFAULT
    ADD SEARCHMETHOD bv_chs(
        I18N au_cst
        CONSTRAINTS (
             ADD id (any) OPT ANY
             ADD name (any) OPT ANY
        )
        OUTPUTLIST (id, name
        )
        WRAPPER (jdbc bv_chs)
    );

CHOWN admin VIEW bv_chs LASTMODIFICATIONUSER admin;

DROP VIEW IF EXISTS bv_ho_orders CASCADE;

CREATE TABLE bv_ho_orders I18N au_cst (
        id:decimal (sourcetypeid = '3', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '38'),
        customer_code:text (sourcetypeid = '12', sourcetyperadix = '10', sourcetypesize = '2650'),
        status:text (sourcetypeid = '12', sourcetyperadix = '10', sourcetypesize = '50'),
        dateplaced:timestamp (sourcetypeid = '93', sourcetyperadix = '10', sourcetypedecimals = '6', sourcetypesize = '11'),
        datedelivered:timestamp (sourcetypeid = '93', sourcetyperadix = '10', sourcetypedecimals = '6', sourcetypesize = '11'),
        dateclosed:timestamp (sourcetypeid = '93', sourcetyperadix = '10', sourcetypedecimals = '6', sourcetypesize = '11')
    )
    CACHE OFF
    TIMETOLIVEINCACHE DEFAULT
    ADD SEARCHMETHOD bv_ho_orders(
        I18N au_cst
        CONSTRAINTS (
             ADD id (any) OPT ANY
             ADD customer_code (any) OPT ANY
             ADD status (any) OPT ANY
             ADD dateplaced (any) OPT ANY
             ADD datedelivered (any) OPT ANY
             ADD dateclosed (any) OPT ANY
        )
        OUTPUTLIST (customer_code, dateclosed, datedelivered, dateplaced, id, status
        )
        WRAPPER (jdbc bv_ho_orders)
    );

CHOWN admin VIEW bv_ho_orders LASTMODIFICATIONUSER admin;

DROP VIEW IF EXISTS coursedetails CASCADE;

CREATE TABLE coursedetails I18N au_cst (
        coursecode:text (notnull, sourcetypeid = '12', sourcetypesize = '4'),
        coursename:text (notnull, sourcetypeid = '12', sourcetypesize = '50'),
        year:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10'),
        coursedurationinhrs:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10'),
        teacher:text (notnull, sourcetypeid = '12', sourcetypesize = '50'),
        objectives:text (sourcetypeid = '2005', sourcetypesize = '2147483647'),
        semester:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10'),
        writtenexam:boolean (sourcetypeid = '-7', sourcetypesize = '1'),
        oralexam:boolean (sourcetypeid = '-7', sourcetypesize = '1'),
        last_modified_date:localdate (sourcetypeid = '91', sourcetypedecimals = '0', sourcetypesize = '10')
    )
    CONSTRAINT 'pk_coursecode' PRIMARY KEY ( 'coursecode' )
    CACHE OFF
    TIMETOLIVEINCACHE DEFAULT
    ADD SEARCHMETHOD coursedetails(
        I18N au_cst
        CONSTRAINTS (
             ADD coursecode (any) OPT ANY
             ADD coursename (any) OPT ANY
             ADD year (any) OPT ANY
             ADD coursedurationinhrs (any) OPT ANY
             ADD teacher (any) OPT ANY
             ADD objectives (any) OPT ANY
             ADD semester (any) OPT ANY
             ADD writtenexam (any) OPT ANY
             ADD oralexam (any) OPT ANY
             ADD last_modified_date (any) OPT ANY
        )
        OUTPUTLIST (coursecode, coursedurationinhrs, coursename, last_modified_date, objectives, oralexam, semester, teacher, writtenexam, year
        )
        WRAPPER (jdbc coursedetails)
    );

CHOWN admin VIEW coursedetails LASTMODIFICATIONUSER admin;

DROP VIEW IF EXISTS rt_coursedetails CASCADE;

CREATE TABLE rt_coursedetails I18N au_cst (
        coursecode:text (sourcetypeid = '12', sourcetypesize = '4'),
        coursename:text (sourcetypeid = '12', sourcetypesize = '50'),
        year:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10'),
        coursedurationinhrs:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10'),
        teacher:text (sourcetypeid = '12', sourcetypesize = '50'),
        objectives:text (sourcetypeid = '12', sourcetypesize = '2147483647'),
        semester:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10'),
        writtenexam:boolean (sourcetypeid = '-7', sourcetypesize = '1'),
        oralexam:boolean (sourcetypeid = '-7', sourcetypesize = '1'),
        last_modified_date:localdate (sourcetypeid = '91', sourcetypedecimals = '0', sourcetypesize = '10')
    )
    CACHE OFF
    TIMETOLIVEINCACHE DEFAULT
    ADD SEARCHMETHOD rt_coursedetails(
        I18N au_cst
        CONSTRAINTS (
             ADD coursecode (any) OPT ANY
             ADD coursename (any) OPT ANY
             ADD year (any) OPT ANY
             ADD coursedurationinhrs (any) OPT ANY
             ADD teacher (any) OPT ANY
             ADD objectives (any) OPT ANY
             ADD semester (any) OPT ANY
             ADD writtenexam (any) OPT ANY
             ADD oralexam (any) OPT ANY
             ADD last_modified_date (any) OPT ANY
        )
        OUTPUTLIST (coursecode, coursedurationinhrs, coursename, last_modified_date, objectives, oralexam, semester, teacher, writtenexam, year
        )
        WRAPPER (jdbc rt_coursedetails)
    )
    DATA_LOAD_QUERY = 'SELECT coursecode, coursename, year, coursedurationinhrs, teacher, objectives, semester, writtenexam, oralexam, last_modified_date
FROM db_gsc.coursedetails';

CHOWN admin VIEW rt_coursedetails LASTMODIFICATIONUSER admin;

DROP VIEW IF EXISTS sql_demo_1 CASCADE;

CREATE TABLE sql_demo_1 I18N au_cst (
        last:text (sourcetypeid = '2005', sourcetypesize = '2147483647'),
        first:text (sourcetypeid = '2005', sourcetypesize = '2147483647'),
        birthdate:blob,
        birthdate1:timestamp (sourcetypeid = '93', sourcetypedecimals = '3', sourcetypesize = '23'),
        num:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10')
    )
    CACHE OFF
    TIMETOLIVEINCACHE DEFAULT
    ADD SEARCHMETHOD sql_demo_1(
        I18N au_cst
        CONSTRAINTS (
             ADD last (any) OPT ANY
             ADD first (any) OPT ANY
             ADD birthdate1 (any) OPT ANY
             ADD num (any) OPT ANY
             ADD birthdate NOS ZERO ()
        )
        OUTPUTLIST (birthdate, birthdate1, first, last, num
        )
        WRAPPER (jdbc sql_demo_1)
    );

CHOWN admin VIEW sql_demo_1 LASTMODIFICATIONUSER admin;

DROP VIEW IF EXISTS sql_demo_2 CASCADE;

CREATE TABLE sql_demo_2 I18N au_cst (
        name:text (sourcetypeid = '-15', sourcetypesize = '10'),
        birthdate:timestamp (sourcetypeid = '93', sourcetypedecimals = '3', sourcetypesize = '23'),
        first:text (sourcetypeid = '2005', sourcetypesize = '2147483647'),
        last:text (sourcetypeid = '2005', sourcetypesize = '2147483647'),
        num2:int (sourcetypeid = '4', sourcetyperadix = '10', sourcetypedecimals = '0', sourcetypesize = '10')
    )
    CACHE OFF
    TIMETOLIVEINCACHE DEFAULT
    ADD SEARCHMETHOD sql_demo_2(
        I18N au_cst
        CONSTRAINTS (
             ADD name (any) OPT ANY
             ADD birthdate (any) OPT ANY
             ADD first (any) OPT ANY
             ADD last (any) OPT ANY
             ADD num2 (any) OPT ANY
        )
        OUTPUTLIST (birthdate, first, last, name, num2
        )
        WRAPPER (jdbc sql_demo_2)
    );

CHOWN admin VIEW sql_demo_2 LASTMODIFICATIONUSER admin;

# #######################################
# VIEWS of db_gsc
# #######################################
# No views in database db_gsc
# #######################################
# ASSOCIATIONS of db_gsc
# #######################################
# No associations in database db_gsc
# #######################################
# WEBSERVICES of db_gsc
# #######################################
# No web services in database db_gsc
# #######################################
# WIDGETS of db_gsc
# #######################################
# No widgets in database db_gsc
# #######################################
# WEBCONTAINER WEB SERVICE DEPLOYMENTS of db_gsc
# #######################################
# No deployed web services in database db_gsc
# #######################################
# WEBCONTAINER WIDGET DEPLOYMENTS of db_gsc
# #######################################
# No deployed widgets in database db_gsc
# #######################################
# VIEW STATISTICS of db_gsc
# #######################################
# No statistics in database db_gsc
# #######################################
# Closing connection with database db_gsc
# #######################################
CLOSE;


# 4 ====================================================================

# #######################################
# DATABASE of db_csi2
# #######################################
DROP DATABASE IF EXISTS db_csi2;

CREATE DATABASE db_csi2;

CONNECT DATABASE db_csi2;

# #######################################
# LISTENERS JMS of db_csi2
# #######################################
# No listeners jms in database db_csi2
# #######################################
# LISTENERS KAFKA of db_csi2
# #######################################
# No listeners kafka in database db_csi2
# #######################################
# DATASOURCES of db_csi2
# #######################################
# No data sources in database db_csi2
# #######################################
# DATABASE CONFIGURATION
# #######################################
ALTER DATABASE db_csi2
  CHARSET DEFAULT;

# #######################################
# WRAPPERS of db_csi2
# #######################################
# No wrappers in database db_csi2
# #######################################
# STORED PROCEDURES of db_csi2
# #######################################
# No stored procedures in database db_csi2
# #######################################
# TYPES of db_csi2
# #######################################
# No types in database db_csi2
# #######################################
# MAPS of db_csi2
# #######################################
# No maps in database db_csi2
# #######################################
# BASE VIEWS of db_csi2
# #######################################
# No base views in database db_csi2
# #######################################
# VIEWS of db_csi2
# #######################################
DROP VIEW IF EXISTS demo_ilu CASCADE;

CREATE VIEW demo_ilu AS SELECT * FROM get_view_columns() WHERE (input_database_name = 'db_csi_1' AND input_view_name = 'customers') CONTEXT ('I18N' = 'us_pst');

CHOWN smtoken VIEW demo_ilu LASTMODIFICATIONUSER smtoken;

DROP VIEW IF EXISTS demo_ilu1 CASCADE;

CREATE VIEW demo_ilu1 AS SELECT 1 FROM dual() CONTEXT ('I18N' = 'us_pst');

CHOWN smtoken VIEW demo_ilu1 LASTMODIFICATIONUSER smtoken;

# #######################################
# ASSOCIATIONS of db_csi2
# #######################################
# No associations in database db_csi2
# #######################################
# WEBSERVICES of db_csi2
# #######################################
# No web services in database db_csi2
# #######################################
# WIDGETS of db_csi2
# #######################################
# No widgets in database db_csi2
# #######################################
# WEBCONTAINER WEB SERVICE DEPLOYMENTS of db_csi2
# #######################################
# No deployed web services in database db_csi2
# #######################################
# WEBCONTAINER WIDGET DEPLOYMENTS of db_csi2
# #######################################
# No deployed widgets in database db_csi2
# #######################################
# VIEW STATISTICS of db_csi2
# #######################################
# No statistics in database db_csi2
# #######################################
# Closing connection with database db_csi2
# #######################################
CLOSE;


# 5 ====================================================================

# #######################################
# DATABASE of db_sql
# #######################################
DROP DATABASE IF EXISTS db_sql;

CREATE DATABASE db_sql;

CONNECT DATABASE db_sql;

# #######################################
# LISTENERS JMS of db_sql
# #######################################
# No listeners jms in database db_sql
# #######################################
# LISTENERS KAFKA of db_sql
# #######################################
# No listeners kafka in database db_sql
# #######################################
# DATASOURCES of db_sql
# #######################################
DROP DATASOURCE JDBC IF EXISTS ds_sql CASCADE;

CREATE DATASOURCE JDBC ds_sql
    DRIVERCLASSNAME = 'com.microsoft.sqlserver.jdbc.SQLServerDriver'
    DATABASEURI = 'jdbc:sqlserver://localhost:1433;databaseName=CollegeInformation'
    USERNAME = 'sa'
    USERPASSWORD = '8MgzDXHm0GmMoYcOPwgEC/ReiG5DG3AjY4hz7OLdat61ynIghmoKLf9FGzdXUlgVYfacIUMhDgLOIBlDmvprq+UGN1b7AVoteJOcE1b3ULT2TM26E8gTOMgilCDJ7+wS' ENCRYPTED
    CLASSPATH = 'mssql-jdbc-7.x'
    DATABASENAME = 'sqlserver'
    DATABASEVERSION = '2017'
    FETCHSIZE = 1000
    VALIDATIONQUERY = 'Select 1'
    INITIALSIZE = 4
    MAXIDLE = -1
    MINIDLE = 0
    MAXACTIVE = 20
    EXHAUSTEDACTION = 1
    TESTONBORROW = true
    TESTONRETURN = false
    TESTWHILEIDLE = false
    TIMEBETWEENEVICTION = -1
    NUMTESTPEREVICTION = 3
    MINEVICTABLETIME = 1800000
    POOLPREPAREDSTATEMENTS = false
    MAXOPENPREPAREDSTATEMENTS = -1
    DATA_LOAD_CONFIGURATION (
        BATCHINSERTSIZE = 1000
    );

CHOWN smtoken DATASOURCE JDBC ds_sql LASTMODIFICATIONUSER smtoken;

# #######################################
# DATABASE CONFIGURATION
# #######################################
ALTER DATABASE db_sql
  CHARSET DEFAULT;

# #######################################
# WRAPPERS of db_sql
# #######################################
DROP WRAPPER JDBC IF EXISTS bv_stem CASCADE;

CREATE WRAPPER JDBC bv_stem
    DATASOURCENAME=ds_sql
    CATALOGNAME='stemina' 
    SCHEMANAME='dbo' 
    RELATIONNAME='bv_stem' 
    OUTPUTSCHEMA (
        date1 = 'date1' :'java.time.LocalDate' (OPT) (sourcetypedecimals='0', sourcetypesize='10', sourcetypeid='91', sourcetypename='date')  SORTABLE,
        date2 = 'date2' :'java.time.LocalDate' (OPT) (sourcetypedecimals='0', sourcetypesize='10', sourcetypeid='91', sourcetypename='date')  SORTABLE
    );

CHOWN admin WRAPPER JDBC bv_stem LASTMODIFICATIONUSER smtoken;

# #######################################
# STORED PROCEDURES of db_sql
# #######################################
# No stored procedures in database db_sql
# #######################################
# TYPES of db_sql
# #######################################
# No types in database db_sql
# #######################################
# MAPS of db_sql
# #######################################
# No maps in database db_sql
# #######################################
# BASE VIEWS of db_sql
# #######################################
DROP VIEW IF EXISTS bv_stem CASCADE;

CREATE TABLE bv_stem I18N au_cst (
        date1:localdate (sourcetypeid = '91', sourcetypedecimals = '0', sourcetypesize = '10'),
        date2:localdate (sourcetypeid = '91', sourcetypedecimals = '0', sourcetypesize = '10')
    )
    CACHE OFF
    TIMETOLIVEINCACHE DEFAULT
    ADD SEARCHMETHOD bv_stem(
        I18N au_cst
        CONSTRAINTS (
             ADD date1 (any) OPT ANY
             ADD date2 (any) OPT ANY
        )
        OUTPUTLIST (date1, date2
        )
        WRAPPER (jdbc bv_stem)
    );

CHOWN admin VIEW bv_stem LASTMODIFICATIONUSER smtoken;

# #######################################
# VIEWS of db_sql
# #######################################
# No views in database db_sql
# #######################################
# ASSOCIATIONS of db_sql
# #######################################
# No associations in database db_sql
# #######################################
# WEBSERVICES of db_sql
# #######################################
# No web services in database db_sql
# #######################################
# WIDGETS of db_sql
# #######################################
# No widgets in database db_sql
# #######################################
# WEBCONTAINER WEB SERVICE DEPLOYMENTS of db_sql
# #######################################
# No deployed web services in database db_sql
# #######################################
# WEBCONTAINER WIDGET DEPLOYMENTS of db_sql
# #######################################
# No deployed widgets in database db_sql
# #######################################
# VIEW STATISTICS of db_sql
# #######################################
# No statistics in database db_sql
# #######################################
# Closing connection with database db_sql
# #######################################
CLOSE;

# #######################################
# Connecting to database admin
# #######################################
CONNECT DATABASE ADMIN;

# #######################################
# USER PRIVILEGES
# #######################################
ALTER USER a
GRANT ROLE allusers
GRANT CONNECT, METADATA, EXECUTE, WRITE ON db_chs;

# #######################################
# ROLE PRIVILEGES
# #######################################
# #######################################
# RESOURCE MANAGER PLANS
# #######################################
# #######################################
# RESOURCE MANAGER RULES
# #######################################
# #######################################
# Closing connection with database admin
# #######################################
CLOSE;

# #######################################
# POLICY CREATION
# #######################################
